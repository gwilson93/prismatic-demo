{"version":3,"file":"jsonforms-core.cjs.js","sources":["../src/generators/schema.ts","../src/models/draft4.ts","../src/models/uischema.ts","../src/util/array.ts","../src/reducers/cells.ts","../src/configDefault.ts","../src/reducers/config.ts","../src/reducers/core.ts","../src/reducers/default-data.ts","../src/i18n/i18nUtil.ts","../src/reducers/i18n.ts","../src/reducers/renderers.ts","../src/testers/testers.ts","../src/reducers/uischemas.ts","../src/reducers/reducers.ts","../src/reducers/selectors.ts","../src/util/path.ts","../src/util/resolvers.ts","../src/util/runtime.ts","../src/util/util.ts","../src/util/label.ts","../src/util/renderer.ts","../src/util/cell.ts","../src/util/combinators.ts","../src/util/ids.ts","../src/util/schema.ts","../src/util/uischema.ts","../src/util/validator.ts","../src/generators/uischema.ts","../src/generators/Generate.ts","../src/actions/actions.ts","../src/Helpers.ts"],"sourcesContent":["/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { JsonSchema4 } from '../models';\n\nconst ADDITIONAL_PROPERTIES = 'additionalProperties';\nconst REQUIRED_PROPERTIES = 'required';\n\ntype Properties = { [property: string]: JsonSchema4 };\n\nconst distinct = (\n  properties: any[],\n  discriminator: (item: any) => string\n): JsonSchema4[] => {\n  const known: { [property: string]: boolean } = {};\n\n  return properties.filter(item => {\n    const discriminatorValue = discriminator(item);\n    if (known.hasOwnProperty(discriminatorValue)) {\n      return false;\n    } else {\n      known[discriminatorValue] = true;\n      return true;\n    }\n  });\n};\n\nclass Gen {\n  constructor(\n    private findOption: (props: Properties) => (optionName: string) => any\n  ) {}\n\n  schemaObject = (data: Object): JsonSchema4 => {\n    const props: Properties = this.properties(data);\n    const schema: JsonSchema4 = {\n      type: 'object',\n      properties: props,\n      additionalProperties: this.findOption(props)(ADDITIONAL_PROPERTIES)\n    };\n    const required = this.findOption(props)(REQUIRED_PROPERTIES);\n    if (required.length > 0) {\n      schema.required = required;\n    }\n\n    return schema;\n  };\n\n  properties = (data: any): Properties => {\n    const emptyProps: Properties = {};\n\n    return Object.keys(data).reduce((acc: Properties, propName: string) => {\n      acc[propName] = this.property(data[propName]);\n\n      return acc;\n    }, emptyProps);\n  };\n\n  property = (data: any): JsonSchema4 => {\n    switch (typeof data) {\n      case 'string':\n        return { type: 'string' };\n      case 'boolean':\n        return { type: 'boolean' };\n      case 'number':\n        if (Number.isInteger(data)) {\n          return { type: 'integer' };\n        }\n\n        return { type: 'number' };\n      case 'object':\n        if (data == null) {\n          return { type: 'null' };\n        }\n\n        return this.schemaObjectOrArray(data);\n      default:\n        return {};\n    }\n  };\n\n  schemaObjectOrArray = (data: any): JsonSchema4 => {\n    if (data instanceof Array) {\n      return this.schemaArray(data as any[]);\n    } else {\n      return this.schemaObject(data);\n    }\n  };\n\n  schemaArray = (data: any[]): JsonSchema4 => {\n    if (data.length > 0) {\n      const allProperties: JsonSchema4[] = data.map(this.property);\n      const uniqueProperties = distinct(allProperties, prop =>\n        JSON.stringify(prop)\n      );\n      if (uniqueProperties.length === 1) {\n        return {\n          type: 'array',\n          items: uniqueProperties[0]\n        };\n      } else {\n        return {\n          type: 'array',\n          items: {\n            oneOf: uniqueProperties\n          }\n        };\n      }\n    } else {\n      return {\n        type: 'array',\n        items: {}\n      };\n    }\n  };\n}\n\n/**\n * Generate a JSON schema based on the given data and any additional options.\n * @param {Object} instance the data to create a JSON schema for\n * @param {any} options any additional options that may alter the generated JSON schema\n * @returns {JsonSchema} the generated schema\n */\nexport const generateJsonSchema = (\n  instance: Object,\n  options: any = {}\n): JsonSchema4 => {\n  const findOption = (props: Properties) => (\n    optionName: string\n  ): boolean | string[] => {\n    switch (optionName) {\n      case ADDITIONAL_PROPERTIES:\n        if (options.hasOwnProperty(ADDITIONAL_PROPERTIES)) {\n          return options[ADDITIONAL_PROPERTIES];\n        }\n\n        return true;\n      case REQUIRED_PROPERTIES:\n        if (options.hasOwnProperty(REQUIRED_PROPERTIES)) {\n          return options[REQUIRED_PROPERTIES](props);\n        }\n\n        return Object.keys(props);\n      default:\n        return;\n    }\n  };\n\n  const gen = new Gen(findOption);\n\n  return gen.schemaObject(instance);\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nexport const Draft4 = {\n  id: 'http://json-schema.org/draft-04/schema#',\n  $schema: 'http://json-schema.org/draft-04/schema#',\n  description: 'Core schema meta-schema',\n  definitions: {\n    schemaArray: {\n      type: 'array',\n      minItems: 1,\n      items: { $ref: '#' }\n    },\n    positiveInteger: {\n      type: 'integer',\n      minimum: 0\n    },\n    positiveIntegerDefault0: {\n      allOf: [{ $ref: '#/definitions/positiveInteger' }, { default: 0 }]\n    },\n    simpleTypes: {\n      enum: [\n        'array',\n        'boolean',\n        'integer',\n        'null',\n        'number',\n        'object',\n        'string'\n      ]\n    },\n    stringArray: {\n      type: 'array',\n      items: { type: 'string' },\n      minItems: 1,\n      uniqueItems: true\n    }\n  },\n  type: 'object',\n  properties: {\n    id: {\n      type: 'string',\n      format: 'uri'\n    },\n    $schema: {\n      type: 'string',\n      format: 'uri'\n    },\n    title: {\n      type: 'string'\n    },\n    description: {\n      type: 'string'\n    },\n    default: {},\n    multipleOf: {\n      type: 'number',\n      minimum: 0,\n      exclusiveMinimum: true\n    },\n    maximum: {\n      type: 'number'\n    },\n    exclusiveMaximum: {\n      type: 'boolean',\n      default: false\n    },\n    minimum: {\n      type: 'number'\n    },\n    exclusiveMinimum: {\n      type: 'boolean',\n      default: false\n    },\n    maxLength: { $ref: '#/definitions/positiveInteger' },\n    minLength: { $ref: '#/definitions/positiveIntegerDefault0' },\n    pattern: {\n      type: 'string',\n      format: 'regex'\n    },\n    additionalItems: {\n      anyOf: [{ type: 'boolean' }, { $ref: '#' }],\n      default: {}\n    },\n    items: {\n      anyOf: [{ $ref: '#' }, { $ref: '#/definitions/schemaArray' }],\n      default: {}\n    },\n    maxItems: { $ref: '#/definitions/positiveInteger' },\n    minItems: { $ref: '#/definitions/positiveIntegerDefault0' },\n    uniqueItems: {\n      type: 'boolean',\n      default: false\n    },\n    maxProperties: { $ref: '#/definitions/positiveInteger' },\n    minProperties: { $ref: '#/definitions/positiveIntegerDefault0' },\n    required: { $ref: '#/definitions/stringArray' },\n    additionalProperties: {\n      anyOf: [{ type: 'boolean' }, { $ref: '#' }],\n      default: {}\n    },\n    definitions: {\n      type: 'object',\n      additionalProperties: { $ref: '#' },\n      default: {}\n    },\n    properties: {\n      type: 'object',\n      additionalProperties: { $ref: '#' },\n      default: {}\n    },\n    patternProperties: {\n      type: 'object',\n      additionalProperties: { $ref: '#' },\n      default: {}\n    },\n    dependencies: {\n      type: 'object',\n      additionalProperties: {\n        anyOf: [{ $ref: '#' }, { $ref: '#/definitions/stringArray' }]\n      }\n    },\n    enum: {\n      type: 'array',\n      minItems: 1,\n      uniqueItems: true\n    },\n    type: {\n      anyOf: [\n        { $ref: '#/definitions/simpleTypes' },\n        {\n          type: 'array',\n          items: { $ref: '#/definitions/simpleTypes' },\n          minItems: 1,\n          uniqueItems: true\n        }\n      ]\n    },\n    allOf: { $ref: '#/definitions/schemaArray' },\n    anyOf: { $ref: '#/definitions/schemaArray' },\n    oneOf: { $ref: '#/definitions/schemaArray' },\n    not: { $ref: '#' }\n  },\n  dependencies: {\n    exclusiveMaximum: ['maximum'],\n    exclusiveMinimum: ['minimum']\n  },\n  default: {}\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { JsonSchema } from './jsonSchema';\n\n/**\n * Interface for describing an UI schema element that is referencing\n * a subschema. The value of the scope may be a JSON Pointer.\n */\nexport interface Scopable {\n  /**\n   * The scope that determines to which part this element should be bound to.\n   */\n  scope?: string;\n}\n\n/**\n * Interface for describing an UI schema element that is referencing\n * a subschema. The value of the scope must be a JSON Pointer.\n */\nexport interface Scoped extends Scopable {\n  /**\n   * The scope that determines to which part this element should be bound to.\n   */\n  scope: string;\n}\n\n/**\n * Interface for describing an UI schema element that may be labeled.\n */\nexport interface Labelable<T = string> {\n  /**\n   * Label for UI schema element.\n   */\n  label?: string|T;\n}\n\n/**\n * Interface for describing an UI schema element that is labeled.\n */\nexport interface Labeled<T = string> extends Labelable<T> {\n  label: string | T;\n}\n\n/*\n * Interface for describing an UI schema element that can provide an internationalization base key.\n * If defined, this key is suffixed to derive applicable message keys for the UI schema element.\n * For example, such suffixes are `.label` or `.description` to derive the corresponding message keys for a control element.\n */\nexport interface Internationalizable {\n  i18n?: string;\n}\n\n/**\n * A rule that may be attached to any UI schema element.\n */\nexport interface Rule {\n  /**\n   * The effect of the rule\n   */\n  effect: RuleEffect;\n\n  /**\n   * The condition of the rule that must evaluate to true in order\n   * to trigger the effect.\n   */\n  condition: Condition;\n}\n\n/**\n * The different rule effects.\n */\nexport enum RuleEffect {\n  /**\n   * Effect that hides the associated element.\n   */\n  HIDE = 'HIDE',\n  /**\n   * Effect that shows the associated element.\n   */\n  SHOW = 'SHOW',\n  /**\n   * Effect that enables the associated element.\n   */\n  ENABLE = 'ENABLE',\n  /**\n   * Effect that disables the associated element.\n   */\n  DISABLE = 'DISABLE'\n}\n\n/**\n * Represents a condition to be evaluated.\n */\nexport interface Condition {\n  /**\n   * The type of condition.\n   */\n  readonly type?: string;\n}\n\n/**\n * A leaf condition.\n */\nexport interface LeafCondition extends Condition, Scoped {\n  type: 'LEAF';\n\n  /**\n   * The expected value when evaluating the condition\n   */\n  expectedValue: any;\n}\n\nexport interface SchemaBasedCondition extends Condition, Scoped {\n  schema: JsonSchema;\n}\n\n/**\n * A composable condition.\n */\nexport interface ComposableCondition extends Condition {\n  conditions: Condition[];\n}\n\n/**\n * An or condition.\n */\nexport interface OrCondition extends ComposableCondition {\n  type: 'OR';\n}\n\n/**\n * An and condition.\n */\nexport interface AndCondition extends ComposableCondition {\n  type: 'AND';\n}\n\n/**\n * Common base interface for any UI schema element.\n */\nexport interface UISchemaElement {\n  /**\n   * The type of this UI schema element.\n   */\n  type: string;\n\n  /**\n   * An optional rule.\n   */\n  rule?: Rule;\n\n  /**\n   * Any additional options.\n   */\n  options?: { [key: string]: any };\n}\n\n/**\n * Represents a layout element which can order its children\n * in a specific way.\n */\nexport interface Layout extends UISchemaElement {\n  /**\n   * The child elements of this layout.\n   */\n  elements: UISchemaElement[];\n}\n\n/**\n * A layout which orders its child elements vertically (i.e. from top to bottom).\n */\nexport interface VerticalLayout extends Layout {\n  type: 'VerticalLayout';\n}\n\n/**\n * A layout which orders its children horizontally (i.e. from left to right).\n */\nexport interface HorizontalLayout extends Layout {\n  type: 'HorizontalLayout';\n}\n\n/**\n * A group resembles a vertical layout, but additionally might have a label.\n * This layout is useful when grouping different elements by a certain criteria.\n */\nexport interface GroupLayout extends Layout, Labelable, Internationalizable {\n  type: 'Group';\n}\n\n/**\n * Represents an object that can be used to configure a label.\n */\nexport interface LabelDescription {\n  /**\n   * An optional text to be displayed.\n   */\n  text?: string;\n  /**\n   * Optional property that determines whether to show this label.\n   */\n  show?: boolean;\n}\n\n/**\n * A label element.\n */\nexport interface LabelElement extends UISchemaElement, Internationalizable {\n  type: 'Label';\n  /**\n   * The text of label.\n   */\n  text: string;\n}\n\n/**\n * A control element. The scope property of the control determines\n * to which part of the schema the control should be bound.\n */\nexport interface ControlElement extends UISchemaElement, Scoped, Labelable<string | boolean | LabelDescription>, Internationalizable {\n  type: 'Control';\n}\n\n/**\n * The category layout.\n */\nexport interface Category extends Layout, Labeled, Internationalizable {\n  type: 'Category';\n}\n\n/**\n * The categorization element, which may have children elements.\n * A child element may either be itself a Categorization or a Category, hence\n * the categorization element can be used to represent recursive structures like trees.\n */\nexport interface Categorization extends UISchemaElement, Labeled, Internationalizable {\n  type: 'Categorization';\n  /**\n   * The child elements of this categorization which are either of type\n   * {@link Category} or {@link Categorization}.\n   */\n  elements: (Category | Categorization)[];\n}\n\nexport const isInternationalized = (element: unknown): element is Required<Internationalizable> =>\n  typeof element === 'object' && element !== null && typeof (element as Internationalizable).i18n === 'string';\n\nexport const isGroup = (layout: Layout): layout is GroupLayout =>\n  layout.type === 'Group';\n\nexport const isLayout = (uischema: UISchemaElement): uischema is Layout =>\n  (uischema as Layout).elements !== undefined;\n\nexport const isScopable = (obj: unknown): obj is Scopable =>\n  !!obj && typeof obj === 'object';\n\nexport const isScoped = (obj: unknown): obj is Scoped =>\n  isScopable(obj) && typeof obj.scope === 'string';\n\nexport const isLabelable = (obj: unknown): obj is Labelable =>\n  !!obj && typeof obj === 'object';\n\nexport const isLabeled = <T = never>(obj: unknown): obj is Labeled<T> =>\n  isLabelable(obj) && ['string', 'boolean'].includes(typeof obj.label);\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nconst move = (array: any[], index: number, delta: number) => {\n  const newIndex: number = index + delta;\n  if (newIndex < 0 || newIndex >= array.length) {\n    return;\n  } // Already at the top or bottom.\n  const indexes: number[] = [index, newIndex].sort((a, b) => a - b); // Sort the indixes\n  array.splice(indexes[0], 2, array[indexes[1]], array[indexes[0]]);\n};\n\nconst moveUp = (array: any[], toMove: number) => {\n  move(array, toMove, -1);\n};\n\nconst moveDown = (array: any[], toMove: number) => {\n  move(array, toMove, 1);\n};\n\nexport { moveUp, moveDown };\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { RankedTester } from '../testers';\nimport {\n  ADD_CELL,\n  AddCellRendererAction,\n  REMOVE_CELL,\n  RemoveCellRendererAction\n} from '../actions';\nimport { Reducer } from '../util';\n\ntype ValidCellReducerActions = AddCellRendererAction | RemoveCellRendererAction;\n\nexport type JsonFormsCellRendererRegistryState = JsonFormsCellRendererRegistryEntry[];\n\nexport interface JsonFormsCellRendererRegistryEntry {\n  tester: RankedTester;\n  cell: any;\n}\n\nexport const cellReducer: Reducer<JsonFormsCellRendererRegistryState, ValidCellReducerActions> = (\n  state = [],\n  { type, tester, cell }\n) => {\n  switch (type) {\n    case ADD_CELL:\n      return state.concat([{ tester, cell }]);\n    case REMOVE_CELL:\n      return state.filter(t => t.tester !== tester);\n    default:\n      return state;\n  }\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nexport const configDefault = {\n  /*\n   * [text] whether to restrict the number of characters to maxLength,\n   * if specified in the JSON schema\n   */\n  restrict: false,\n\n  /*\n   * [text] whether to resize the input's width to maxLength,\n   * if specified in the JSON schema\n   */\n  trim: false,\n\n  /*\n   * [text] if input descriptions should hide when not focused\n   */\n  showUnfocusedDescription: false,\n\n  /*\n   * [text] if asterisks in labels for required fields should be hidden\n   */\n  hideRequiredAsterisk: false\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport merge from 'lodash/merge';\nimport { SET_CONFIG, SetConfigAction } from '../actions';\nimport { configDefault } from '../configDefault';\nimport { Reducer } from '../util';\n\nconst applyDefaultConfiguration = (config: any = {}) =>\n  merge({}, configDefault, config);\n\nexport const configReducer: Reducer<any, SetConfigAction> = (\n  state = applyDefaultConfiguration(),\n  action\n) => {\n  switch (action.type) {\n    case SET_CONFIG:\n      return applyDefaultConfiguration(action.config);\n    default:\n      return state;\n  }\n};\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport cloneDeep from 'lodash/cloneDeep';\nimport setFp from 'lodash/fp/set';\nimport get from 'lodash/get';\nimport filter from 'lodash/filter';\nimport isEqual from 'lodash/isEqual';\nimport isFunction from 'lodash/isFunction';\nimport Ajv, { ErrorObject, ValidateFunction } from 'ajv';\nimport {\n  CoreActions,\n  INIT,\n  InitAction,\n  InitActionOptions,\n  SET_AJV,\n  SET_SCHEMA,\n  SET_UISCHEMA,\n  SET_VALIDATION_MODE,\n  UPDATE_DATA,\n  UPDATE_ERRORS,\n  UPDATE_CORE,\n  UpdateCoreAction\n} from '../actions';\nimport { createAjv, Reducer } from '../util';\nimport { JsonSchema, UISchemaElement } from '../models';\n\nexport const validate = (validator: ValidateFunction | undefined, data: any): ErrorObject[] => {\n  if (validator === undefined) {\n    return [];\n  }\n  const valid = validator(data);\n  if (valid) {\n    return [];\n  }\n  return validator.errors;\n};\n\nexport type ValidationMode = 'ValidateAndShow' | 'ValidateAndHide' | 'NoValidation';\n\nexport interface JsonFormsCore {\n  data: any;\n  schema: JsonSchema;\n  uischema: UISchemaElement;\n  errors?: ErrorObject[];\n  additionalErrors?: ErrorObject[];\n  validator?: ValidateFunction;\n  ajv?: Ajv;\n  validationMode?: ValidationMode;\n}\n\nconst initState: JsonFormsCore = {\n  data: {},\n  schema: {},\n  uischema: undefined,\n  errors: [],\n  validator: undefined,\n  ajv: undefined,\n  validationMode: 'ValidateAndShow',\n  additionalErrors: []\n};\n\nconst reuseAjvForSchema = (ajv: Ajv, schema: JsonSchema): Ajv => {\n  if (schema.hasOwnProperty('id') || schema.hasOwnProperty('$id')) {\n    ajv.removeSchema(schema);\n  }\n  return ajv;\n};\n\nconst getOrCreateAjv = (state: JsonFormsCore, action?: InitAction | UpdateCoreAction): Ajv => {\n  if (action) {\n    if (hasAjvOption(action.options)) {\n      // options object with ajv\n      return action.options.ajv;\n    } else if (\n      action.options !== undefined\n    ) {\n      // it is not an option object => should be ajv itself => check for compile function\n      if (isFunction(action.options.compile)) {\n        return action.options;\n      }\n    }\n  }\n  if (state.ajv) {\n    return action?.schema\n      ? reuseAjvForSchema(state.ajv, action.schema)\n      : state.ajv;\n  }\n  return createAjv();\n};\n\nconst hasAjvOption = (option: any): option is InitActionOptions => {\n  if (option) {\n    return option.ajv !== undefined;\n  }\n  return false;\n};\n\nconst getValidationMode = (\n  state: JsonFormsCore,\n  action?: InitAction | UpdateCoreAction\n): ValidationMode => {\n  if (action && hasValidationModeOption(action.options)) {\n    return action.options.validationMode;\n  }\n  return state.validationMode;\n};\n\nconst hasValidationModeOption = (option: any): option is InitActionOptions => {\n  if (option) {\n    return option.validationMode !== undefined;\n  }\n  return false;\n};\n\nconst hasAdditionalErrorsOption = (option: any): option is InitActionOptions => {\n  if (option) {\n    return option.additionalErrors !== undefined;\n  }\n  return false;\n};\n\nconst getAdditionalErrors = (\n  state: JsonFormsCore,\n  action?: InitAction | UpdateCoreAction\n): ErrorObject[] => {\n  if (action && hasAdditionalErrorsOption(action.options)) {\n    return action.options.additionalErrors;\n  }\n  return state.additionalErrors;\n};\n\n// tslint:disable-next-line: cyclomatic-complexity\nexport const coreReducer: Reducer<JsonFormsCore, CoreActions> = (\n  state = initState,\n  action\n) => {\n  switch (action.type) {\n    case INIT: {\n      const thisAjv = getOrCreateAjv(state, action);\n\n      const validationMode = getValidationMode(state, action);\n      const v = validationMode === 'NoValidation' ? undefined : thisAjv.compile(action.schema);\n      const e = validate(v, action.data);\n      const additionalErrors = getAdditionalErrors(state, action);\n\n      return {\n        ...state,\n        data: action.data,\n        schema: action.schema,\n        uischema: action.uischema,\n        additionalErrors,\n        errors: e,\n        validator: v,\n        ajv: thisAjv,\n        validationMode,\n      };\n    }\n    case UPDATE_CORE: {\n      const thisAjv = getOrCreateAjv(state, action);\n      const validationMode = getValidationMode(state, action);\n      let validator = state.validator;\n      let errors = state.errors;\n      if (\n        state.schema !== action.schema ||\n        state.validationMode !== validationMode ||\n        state.ajv !== thisAjv\n      ) {\n        // revalidate only if necessary\n        validator =\n          validationMode === 'NoValidation'\n            ? undefined\n            : thisAjv.compile(action.schema);\n        errors = validate(validator, action.data);\n      } else if (state.data !== action.data) {\n        errors = validate(validator, action.data);\n      }\n      const additionalErrors = getAdditionalErrors(state, action);\n\n      const stateChanged =\n        state.data !== action.data ||\n        state.schema !== action.schema ||\n        state.uischema !== action.uischema ||\n        state.ajv !== thisAjv ||\n        state.errors !== errors ||\n        state.validator !== validator ||\n        state.validationMode !== validationMode ||\n        state.additionalErrors !== additionalErrors\n      return stateChanged\n        ? {\n            ...state,\n            data: action.data,\n            schema: action.schema,\n            uischema: action.uischema,\n            ajv: thisAjv,\n            errors: isEqual(errors, state.errors) ? state.errors : errors,\n            validator: validator,\n            validationMode: validationMode,\n            additionalErrors\n          }\n        : state;\n    }\n    case SET_AJV: {\n      const currentAjv = action.ajv;\n      const validator = state.validationMode === 'NoValidation' ? undefined : currentAjv.compile(state.schema);\n      const errors = validate(validator, state.data);\n      return {\n        ...state,\n        validator,\n        errors\n      };\n    }\n    case SET_SCHEMA: {\n      const needsNewValidator = action.schema && state.ajv && state.validationMode !== 'NoValidation';\n      const v = needsNewValidator\n        ? reuseAjvForSchema(state.ajv, action.schema).compile(action.schema)\n        : state.validator;\n      const errors = validate(v, state.data);\n      return {\n        ...state,\n        validator: v,\n        schema: action.schema,\n        errors\n      };\n    }\n    case SET_UISCHEMA: {\n      return {\n        ...state,\n        uischema: action.uischema\n      };\n    }\n    case UPDATE_DATA: {\n      if (action.path === undefined || action.path === null) {\n        return state;\n      } else if (action.path === '') {\n        // empty path is ok\n        const result = action.updater(cloneDeep(state.data));\n        const errors = validate(state.validator, result);\n        return {\n          ...state,\n          data: result,\n          errors\n        };\n      } else {\n        const oldData: any = get(state.data, action.path);\n        const newData = action.updater(cloneDeep(oldData));\n        const newState: any = setFp(\n          action.path,\n          newData,\n          state.data === undefined ? {} : state.data\n        );\n        const errors = validate(state.validator, newState);\n        return {\n          ...state,\n          data: newState,\n          errors\n        };\n      }\n    }\n    case UPDATE_ERRORS: {\n      return {\n        ...state,\n        errors: action.errors\n      };\n    }\n    case SET_VALIDATION_MODE: {\n      if (state.validationMode === action.validationMode) {\n        return state;\n      }\n      if (action.validationMode === 'NoValidation') {\n        const errors = validate(undefined, state.data);\n        return {\n          ...state,\n          errors,\n          validationMode: action.validationMode\n        };\n      }\n      if (state.validationMode === 'NoValidation') {\n        const validator = reuseAjvForSchema(state.ajv, state.schema).compile(state.schema);\n        const errors = validate(validator, state.data);\n        return {\n          ...state,\n          validator,\n          errors,\n          validationMode: action.validationMode\n        };\n      }\n      return {\n        ...state,\n        validationMode: action.validationMode\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nexport const extractData = (state: JsonFormsCore) => get(state, 'data');\nexport const extractSchema = (state: JsonFormsCore) => get(state, 'schema');\nexport const extractUiSchema = (state: JsonFormsCore) => get(state, 'uischema');\nexport const extractAjv = (state: JsonFormsCore) => get(state, 'ajv');\n\nconst getInvalidProperty = (error: ErrorObject): string | undefined => {\n  switch (error.keyword) {\n    case 'required':\n    case 'dependencies':\n      return error.params.missingProperty;\n    case 'additionalProperties':\n      return error.params.additionalProperty;\n    default:\n      return undefined;\n  }\n};\n\nexport const getControlPath = (error: ErrorObject) => {\n  const dataPath = (error as any).dataPath;\n  // older AJV version\n  if (dataPath) {\n    return dataPath.replace(/\\//g, '.').substr(1);\n  }\n  // dataPath was renamed to instancePath in AJV v8\n  var controlPath: string = error.instancePath;\n\n  // change '/' chars to '.'\n  controlPath = controlPath.replace(/\\//g, '.');\n  \n  const invalidProperty = getInvalidProperty(error);\n  if (invalidProperty !== undefined && !controlPath.endsWith(invalidProperty)) {\n    controlPath = `${controlPath}.${invalidProperty}`;\n  }\n  \n  // remove '.' chars at the beginning of paths\n  controlPath = controlPath.replace(/^./, '');\n  return controlPath;\n}\n\nexport const errorsAt = (\n  instancePath: string,\n  schema: JsonSchema,\n  matchPath: (path: string) => boolean\n) => (errors: ErrorObject[]): ErrorObject[] => {\n  // Get data paths of oneOf and anyOf errors to later determine whether an error occurred inside a subschema of oneOf or anyOf.\n  const combinatorPaths = filter(\n    errors,\n    error => error.keyword === 'oneOf' || error.keyword === 'anyOf'\n    ).map(error => getControlPath(error));\n    \n    return filter(errors, error => {\n      // Filter errors that match any keyword that we don't want to show in the UI\n      if (filteredErrorKeywords.indexOf(error.keyword) !== -1) {\n        return false;\n      }\n    const controlPath = getControlPath(error);\n    let result = matchPath(controlPath);\n    // In anyOf and oneOf blocks with \"primitive\" (i.e. string, number etc.) or array subschemas,\n    // we want to make sure that errors are only shown for the correct subschema.\n    // Therefore, we compare the error's parent schema with the property's schema.\n    // In the primitive case the error's data path is the same for all subschemas:\n    // It directly points to the property defining the anyOf/oneOf.\n    // The same holds true for errors on the array level (e.g. min item amount).\n    // In contrast, this comparison must not be done for errors whose parent schema defines an object\n    // because the parent schema can never match the property schema (e.g. for 'required' checks).\n    const parentSchema: JsonSchema | undefined = error.parentSchema;\n    if (result && !isObjectSchema(parentSchema)\n      && combinatorPaths.findIndex(p => instancePath.startsWith(p)) !== -1) {\n      result = result && isEqual(parentSchema, schema);\n    }\n    return result;\n  });\n};\n\n/**\n * @returns true if the schema describes an object.\n */\nconst isObjectSchema = (schema?: JsonSchema): boolean => {\n  return schema?.type === 'object' || !!schema?.properties;\n}\n\n/**\n * The error-type of an AJV error is defined by its `keyword` property.\n * Certain errors are filtered because they don't fit to any rendered control.\n * All of them have in common that we don't want to show them in the UI\n * because controls will show the actual reason why they don't match their correponding sub schema.\n * - additionalProperties: Indicates that a property is present that is not defined in the schema.\n *      Jsonforms only allows to edit defined properties. These errors occur if an oneOf doesn't match.\n * - allOf: Indicates that not all of the allOf definitions match as a whole.\n * - anyOf: Indicates that an anyOf definition itself is not valid because none of its subschemas matches.\n * - oneOf: Indicates that an oneOf definition itself is not valid because not exactly one of its subschemas matches.\n */\nconst filteredErrorKeywords = ['additionalProperties', 'allOf', 'anyOf', 'oneOf'];\n\nconst getErrorsAt = (\n  instancePath: string,\n  schema: JsonSchema,\n  matchPath: (path: string) => boolean\n) => (state: JsonFormsCore): ErrorObject[] => {\n  const errors = state.errors ?? [];\n  const additionalErrors = state.additionalErrors ?? [];\n  return errorsAt(instancePath, schema, matchPath)(state.validationMode === 'ValidateAndHide' ? additionalErrors : [...errors, ...additionalErrors]);\n}\n\nexport const errorAt = (instancePath: string, schema: JsonSchema) =>\n  getErrorsAt(instancePath, schema, path => path === instancePath);\nexport const subErrorsAt = (instancePath: string, schema: JsonSchema) =>\n  getErrorsAt(instancePath, schema, path => path.startsWith(instancePath));\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport {\n  ADD_DEFAULT_DATA,\n  RegisterDefaultDataAction,\n  REMOVE_DEFAULT_DATA,\n  UnregisterDefaultDataAction\n} from '../actions';\nimport { Reducer } from '../util';\n\nexport interface JsonFormsDefaultDataRegistryEntry {\n  schemaPath: string;\n  data: any;\n}\n\ntype ValidDefaultDataActions =\n  | RegisterDefaultDataAction\n  | UnregisterDefaultDataAction;\n\nexport const defaultDataReducer: Reducer<JsonFormsDefaultDataRegistryEntry[], ValidDefaultDataActions> = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case ADD_DEFAULT_DATA:\n      return state.concat([\n        { schemaPath: action.schemaPath, data: action.data }\n      ]);\n    case REMOVE_DEFAULT_DATA:\n      return state.filter(t => t.schemaPath !== action.schemaPath);\n    default:\n      return state;\n  }\n};\n\nexport const extractDefaultData = (\n  state: JsonFormsDefaultDataRegistryEntry[]\n): JsonFormsDefaultDataRegistryEntry[] => state;\n","import { ErrorObject } from 'ajv';\nimport { isInternationalized, Labelable, UISchemaElement } from '../models';\nimport { getControlPath } from '../reducers';\nimport { formatErrorMessage } from '../util';\nimport { i18nJsonSchema, ErrorTranslator, Translator } from './i18nTypes';\n\nexport const getI18nKeyPrefixBySchema = (\n  schema: i18nJsonSchema | undefined,\n  uischema: unknown | undefined\n): string | undefined => {\n  if (isInternationalized(uischema)) {\n    return uischema.i18n;\n  }\n  return schema?.i18n ?? undefined;\n};\n\n/**\n * Transforms a given path to a prefix which can be used for i18n keys.\n * Returns 'root' for empty paths and removes array indices\n */\nexport const transformPathToI18nPrefix = (path: string): string => {\n  return (\n    path\n      ?.split('.')\n      .filter(segment => !/^\\d+$/.test(segment))\n      .join('.') || 'root'\n  );\n};\n\nexport const getI18nKeyPrefix = (\n  schema: i18nJsonSchema | undefined,\n  uischema: unknown | undefined,\n  path: string | undefined\n): string => {\n  return (\n    getI18nKeyPrefixBySchema(schema, uischema) ??\n    transformPathToI18nPrefix(path)\n  );\n};\n\nexport const getI18nKey = (\n  schema: i18nJsonSchema | undefined,\n  uischema: unknown | undefined,\n  path: string | undefined,\n  key: string\n): string => {\n  return `${getI18nKeyPrefix(schema, uischema, path)}.${key}`;\n};\n\nexport const defaultTranslator: Translator = (_id: string, defaultMessage: string | undefined) => defaultMessage;\n\nexport const defaultErrorTranslator: ErrorTranslator = (error, t, uischema) => {\n  // check whether there is a special keyword message\n  const i18nKey = getI18nKey(\n    error.parentSchema,\n    uischema,\n    getControlPath(error),\n    `error.${error.keyword}`\n  );\n  const specializedKeywordMessage = t(i18nKey, undefined, { error } );\n  if (specializedKeywordMessage !== undefined) {\n    return specializedKeywordMessage;\n  }\n\n  // check whether there is a generic keyword message\n  const genericKeywordMessage = t(`error.${error.keyword}`, undefined, { error });\n  if (genericKeywordMessage !== undefined) {\n    return genericKeywordMessage;\n  }\n\n  // check whether there is a customization for the default message\n  const messageCustomization = t(error.message, undefined, { error });\n  if (messageCustomization !== undefined) {\n    return messageCustomization;\n  }\n\n  // rewrite required property messages (if they were not customized) as we place them next to the respective input\n  if (error.keyword === 'required' && error.message?.startsWith('must have required property')) {\n    return t('is a required property', 'is a required property', { error });\n  }\n\n  return error.message;\n};\n\n/**\n * Returns the determined error message for the given errors.\n * All errors must correspond to the given schema, uischema or path.\n */\nexport const getCombinedErrorMessage = (\n  errors: ErrorObject[],\n  et: ErrorTranslator,\n  t: Translator,\n  schema?: i18nJsonSchema,\n  uischema?: UISchemaElement,\n  path?: string\n) => {\n  if (errors.length > 0 && t) {\n    // check whether there is a special message which overwrites all others\n    const customErrorKey = getI18nKey(schema, uischema, path, 'error.custom');\n    const specializedErrorMessage = t(customErrorKey, undefined, {schema, uischema, path, errors});\n    if (specializedErrorMessage !== undefined) {\n      return specializedErrorMessage;\n    }\n  }\n  return formatErrorMessage(\n    errors.map(error => et(error, t, uischema))\n  );\n};\n\n/**\n * This can be used to internationalize the label of the given Labelable (e.g. UI Schema elements).\n * This should not be used for controls as there we have additional context in the form of the JSON Schema available.\n */\nexport const deriveLabelForUISchemaElement = (uischema: Labelable<boolean>, t: Translator): string | undefined => {\n  if (uischema.label === false) {\n    return undefined;\n  }\n  if ((uischema.label === undefined || uischema.label === null || uischema.label === true) && !isInternationalized(uischema)) {\n    return undefined;\n  }\n  const stringifiedLabel = typeof uischema.label === 'string' ? uischema.label : JSON.stringify(uischema.label);\n  const i18nKeyPrefix = getI18nKeyPrefixBySchema(undefined, uischema);\n  const i18nKey = typeof i18nKeyPrefix === 'string' ? `${i18nKeyPrefix}.label` : stringifiedLabel;\n  return t(i18nKey, stringifiedLabel, { uischema: uischema });\n}\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { defaultErrorTranslator, defaultTranslator, JsonFormsI18nState } from '../i18n';\nimport { I18nActions, SET_LOCALE, SET_TRANSLATOR, UPDATE_I18N } from '../actions';\nimport { Reducer } from '../util';\n\nexport const defaultJsonFormsI18nState: Required<JsonFormsI18nState> = {\n  locale: 'en',\n  translate: defaultTranslator,\n  translateError: defaultErrorTranslator\n};\n\nexport const i18nReducer: Reducer<JsonFormsI18nState, I18nActions> = (state = defaultJsonFormsI18nState, action) => {\n  switch (action.type) {\n    case UPDATE_I18N: {\n      const locale = action.locale ?? defaultJsonFormsI18nState.locale;\n      const translate =\n        action.translator ?? defaultJsonFormsI18nState.translate;\n      const translateError =\n        action.errorTranslator ?? defaultJsonFormsI18nState.translateError;\n\n      if (\n        locale !== state.locale ||\n        translate !== state.translate ||\n        translateError !== state.translateError\n      ) {\n        return {\n          ...state,\n          locale,\n          translate,\n          translateError\n        };\n      }\n      return state;\n    }\n    case SET_TRANSLATOR:\n      return {\n        ...state,\n        translate: action.translator ?? defaultTranslator,\n        translateError: action.errorTranslator ?? defaultErrorTranslator\n      };\n    case SET_LOCALE:\n      return {\n        ...state,\n        locale: action.locale ?? navigator.languages[0]\n      };\n    default:\n      return state;\n  }\n};\n\nexport const fetchLocale = (state?: JsonFormsI18nState) => {\n  if (state === undefined) {\n    return undefined;\n  }\n  return state.locale;\n};\n\nexport const fetchTranslator = (state?: JsonFormsI18nState) => {\n  if (state === undefined) {\n    return defaultTranslator;\n  }\n  return state.translate;\n}\n\nexport const fetchErrorTranslator = (state?: JsonFormsI18nState) => {\n  if (state === undefined) {\n    return defaultErrorTranslator;\n  }\n  return state.translateError;\n}\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { RankedTester } from '../testers';\nimport {\n  ADD_RENDERER,\n  AddRendererAction,\n  REMOVE_RENDERER,\n  RemoveRendererAction\n} from '../actions';\nimport { Reducer } from '../util';\n\nexport interface JsonFormsRendererRegistryEntry {\n  tester: RankedTester;\n  renderer: any;\n}\n\ntype ValidRendererReducerActions = AddRendererAction | RemoveRendererAction;\n\nexport const rendererReducer: Reducer<JsonFormsRendererRegistryEntry[], ValidRendererReducerActions> = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case ADD_RENDERER:\n      return state.concat([\n        { tester: action.tester, renderer: action.renderer }\n      ]);\n    case REMOVE_RENDERER:\n      return state.filter(t => t.tester !== action.tester);\n    default:\n      return state;\n  }\n};\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport isEmpty from 'lodash/isEmpty';\nimport get from 'lodash/get';\nimport endsWith from 'lodash/endsWith';\nimport last from 'lodash/last';\nimport isArray from 'lodash/isArray';\nimport reduce from 'lodash/reduce';\nimport toPairs from 'lodash/toPairs';\nimport includes from 'lodash/includes';\nimport {\n  Categorization,\n  ControlElement,\n  JsonSchema,\n  UISchemaElement\n} from '../models';\nimport { deriveTypes, hasType, resolveSchema } from '../util';\n\n/**\n * Constant that indicates that a tester is not capable of handling\n * a combination of schema/data.\n * @type {number}\n */\nexport const NOT_APPLICABLE = -1;\n/**\n * A tester is a function that receives an UI schema and a JSON schema and returns a boolean.\n * The rootSchema is handed over as context. Can be used to resolve references.\n */\nexport type Tester = (uischema: UISchemaElement, schema: JsonSchema, context: TesterContext) => boolean;\n\n/**\n * A ranked tester associates a tester with a number.\n */\nexport type RankedTester = (\n  uischema: UISchemaElement,\n  schema: JsonSchema,\n  context: TesterContext\n) => number;\n\n/**\n * Additional context given to a tester in addition to UISchema and JsonSchema.\n */\nexport interface TesterContext {\n  /** The root JsonSchema of the form. Can be used to resolve references. */\n  rootSchema: JsonSchema;\n  /** The form wide configuration object given to JsonForms. */\n  config: any;\n}\n\nexport const isControl = (uischema: any): uischema is ControlElement =>\n  !isEmpty(uischema) && uischema.scope !== undefined;\n\n/**\n * Only applicable for Controls.\n *\n * This function checks whether the given UI schema is of type Control\n * and if so, resolves the sub-schema referenced by the control and applies\n * the given predicate\n *\n * @param {(JsonSchema) => boolean} predicate the predicate that should be\n *        applied to the resolved sub-schema\n */\nexport const schemaMatches = (\n  predicate: (schema: JsonSchema, rootSchema: JsonSchema) => boolean\n): Tester => (uischema: UISchemaElement, schema: JsonSchema, context: TesterContext): boolean => {\n  if (isEmpty(uischema) || !isControl(uischema)) {\n    return false;\n  }\n  if (isEmpty(schema)) {\n    return false;\n  }\n  const schemaPath = uischema.scope;\n  if (isEmpty(schemaPath)) {\n    return false;\n  }\n  let currentDataSchema = schema;\n  if (hasType(schema, 'object')) {\n    currentDataSchema = resolveSchema(schema, schemaPath, context?.rootSchema);\n  }\n  if (currentDataSchema === undefined) {\n    return false;\n  }\n\n  return predicate(currentDataSchema, context?.rootSchema);\n};\n\nexport const schemaSubPathMatches = (\n  subPath: string,\n  predicate: (schema: JsonSchema, rootSchema: JsonSchema) => boolean\n): Tester => (uischema: UISchemaElement, schema: JsonSchema, context: TesterContext): boolean => {\n  if (isEmpty(uischema) || !isControl(uischema)) {\n    return false;\n  }\n  const schemaPath = uischema.scope;\n  let currentDataSchema: JsonSchema = schema;\n  if (hasType(schema, 'object')) {\n    currentDataSchema = resolveSchema(schema, schemaPath, context?.rootSchema);\n  }\n  currentDataSchema = get(currentDataSchema, subPath);\n\n  if (currentDataSchema === undefined) {\n    return false;\n  }\n\n  return predicate(currentDataSchema, context?.rootSchema);\n};\n\n/**\n * Only applicable for Controls.\n *\n * This function checks whether the given UI schema is of type Control\n * and if so, resolves the sub-schema referenced by the control and checks\n * whether the type of the sub-schema matches the expected one.\n *\n * @param {string} expectedType the expected type of the resolved sub-schema\n */\nexport const schemaTypeIs = (expectedType: string): Tester =>\n  schemaMatches(schema => !isEmpty(schema) && hasType(schema, expectedType));\n\n/**\n * Only applicable for Controls.\n *\n * This function checks whether the given UI schema is of type Control\n * and if so, resolves the sub-schema referenced by the control and checks\n * whether the format of the sub-schema matches the expected one.\n *\n * @param {string} expectedFormat the expected format of the resolved sub-schema\n */\nexport const formatIs = (expectedFormat: string): Tester =>\n  schemaMatches(\n    schema =>\n      !isEmpty(schema) &&\n      schema.format === expectedFormat &&\n      hasType(schema, 'string')\n  );\n\n/**\n * Checks whether the given UI schema has the expected type.\n *\n * @param {string} expected the expected UI schema type\n */\nexport const uiTypeIs = (expected: string): Tester => (\n  uischema: UISchemaElement\n): boolean => !isEmpty(uischema) && uischema.type === expected;\n\n/**\n * Checks whether the given UI schema has an option with the given\n * name and whether it has the expected value. If no options property\n * is set, returns false.\n *\n * @param {string} optionName the name of the option to check\n * @param {any} optionValue the expected value of the option\n */\nexport const optionIs = (optionName: string, optionValue: any): Tester => (\n  uischema: UISchemaElement\n): boolean => {\n  if (isEmpty(uischema)) {\n    return false;\n  }\n\n  const options = uischema.options;\n  return !isEmpty(options) && options[optionName] === optionValue;\n};\n\n/**\n * Only applicable for Controls.\n *\n * Checks whether the scope of a control ends with the expected string.\n *\n * @param {string} expected the expected ending of the reference\n */\nexport const scopeEndsWith = (expected: string): Tester => (\n  uischema: UISchemaElement\n): boolean => {\n  if (isEmpty(expected) || !isControl(uischema)) {\n    return false;\n  }\n\n  return endsWith(uischema.scope, expected);\n};\n\n/**\n * Only applicable for Controls.\n *\n * Checks whether the last segment of the scope matches the expected string.\n *\n * @param {string} expected the expected ending of the reference\n */\nexport const scopeEndIs = (expected: string): Tester => (\n  uischema: UISchemaElement\n): boolean => {\n  if (isEmpty(expected) || !isControl(uischema)) {\n    return false;\n  }\n  const schemaPath = uischema.scope;\n\n  return !isEmpty(schemaPath) && last(schemaPath.split('/')) === expected;\n};\n\n/**\n * A tester that allow composing other testers by && them.\n *\n * @param {Array<Tester>} testers the testers to be composed\n */\nexport const and = (...testers: Tester[]): Tester => (\n  uischema: UISchemaElement,\n  schema: JsonSchema,\n  context: TesterContext\n) => testers.reduce((acc, tester) => acc && tester(uischema, schema, context), true);\n\n/**\n * A tester that allow composing other testers by || them.\n *\n * @param {Array<Tester>} testers the testers to be composed\n */\nexport const or = (...testers: Tester[]): Tester => (\n  uischema: UISchemaElement,\n  schema: JsonSchema,\n  context: TesterContext\n) => testers.reduce((acc, tester) => acc || tester(uischema, schema, context), false);\n/**\n * Create a ranked tester that will associate a number with a given tester, if the\n * latter returns true.\n *\n * @param {number} rank the rank to be returned in case the tester returns true\n * @param {Tester} tester a tester\n */\nexport const rankWith = (rank: number, tester: Tester) => (\n  uischema: UISchemaElement,\n  schema: JsonSchema,\n  context: TesterContext\n): number => {\n  if (tester(uischema, schema, context)) {\n    return rank;\n  }\n\n  return NOT_APPLICABLE;\n};\n\nexport const withIncreasedRank = (by: number, rankedTester: RankedTester) => (\n  uischema: UISchemaElement,\n  schema: JsonSchema,\n  context: TesterContext\n): number => {\n  const rank = rankedTester(uischema, schema, context);\n  if (rank === NOT_APPLICABLE) {\n    return NOT_APPLICABLE;\n  }\n\n  return rank + by;\n};\n\n/**\n * Default tester for boolean.\n * @type {RankedTester}\n */\nexport const isBooleanControl = and(\n  uiTypeIs('Control'),\n  schemaTypeIs('boolean')\n);\n\n// TODO: rather check for properties property\nexport const isObjectControl = and(uiTypeIs('Control'), schemaTypeIs('object'));\n\nexport const isAllOfControl = and(\n  uiTypeIs('Control'),\n  schemaMatches(schema => schema.hasOwnProperty('allOf'))\n);\n\nexport const isAnyOfControl = and(\n  uiTypeIs('Control'),\n  schemaMatches(schema => schema.hasOwnProperty('anyOf'))\n);\n\nexport const isOneOfControl = and(\n  uiTypeIs('Control'),\n  schemaMatches(schema => schema.hasOwnProperty('oneOf'))\n);\n\n/**\n * Tests whether the given UI schema is of type Control and if the schema\n * has an enum.\n * @type {Tester}\n */\nexport const isEnumControl = and(\n  uiTypeIs('Control'),\n  or(\n    schemaMatches(schema => schema.hasOwnProperty('enum')),\n    schemaMatches(schema => schema.hasOwnProperty('const'))\n  )\n);\n\n/**\n * Tests whether the given UI schema is of type Control and if the schema\n * has an enum based on oneOf.\n * @type {Tester}\n */\nexport const isOneOfEnumControl = and(\n  uiTypeIs('Control'),\n  schemaMatches(schema =>\n    schema.hasOwnProperty('oneOf') &&\n    (schema.oneOf as JsonSchema[]).every(s => s.const !== undefined)\n  )\n);\n\n/**\n * Tests whether the given UI schema is of type Control and if the schema\n * is of type integer\n * @type {Tester}\n */\nexport const isIntegerControl = and(\n  uiTypeIs('Control'),\n  schemaTypeIs('integer')\n);\n\n/**\n * Tests whether the given UI schema is of type Control and if the schema\n * is of type number\n * @type {Tester}\n */\nexport const isNumberControl = and(uiTypeIs('Control'), schemaTypeIs('number'));\n\n/**\n * Tests whether the given UI schema is of type Control and if the schema\n * is of type string\n * @type {Tester}\n */\nexport const isStringControl = and(uiTypeIs('Control'), schemaTypeIs('string'));\n\n/**\n * Tests whether the given UI schema is of type Control and if is has\n * a 'multi' option.\n * @type {Tester}\n */\nexport const isMultiLineControl = and(\n  uiTypeIs('Control'),\n  optionIs('multi', true)\n);\n\n/**\n * Tests whether the given UI schema is of type Control and whether the schema\n * or uischema options has a 'date' format.\n * @type {Tester}\n */\nexport const isDateControl = and(\n  uiTypeIs('Control'),\n  or(formatIs('date'), optionIs('format', 'date'))\n);\n\n/**\n * Tests whether the given UI schema is of type Control and whether the schema\n * or the uischema options has a 'time' format.\n * @type {Tester}\n */\nexport const isTimeControl = and(\n  uiTypeIs('Control'),\n  or(formatIs('time'), optionIs('format', 'time'))\n);\n\n/**\n * Tests whether the given UI schema is of type Control and whether the schema\n * or the uischema options has a 'date-time' format.\n * @type {Tester}\n */\nexport const isDateTimeControl = and(\n  uiTypeIs('Control'),\n  or(formatIs('date-time'), optionIs('format', 'date-time'))\n);\n\n/**\n * Tests whether the given schema is an array of objects.\n * @type {Tester}\n */\nexport const isObjectArray = and(\n  schemaMatches(\n    (schema, rootSchema) => hasType(schema, 'array') && !Array.isArray(resolveSchema(schema, 'items', rootSchema)) // we don't care about tuples\n  ),\n  schemaSubPathMatches('items', (schema, rootSchema) => {\n    const resolvedSchema = schema.$ref ? resolveSchema(rootSchema, schema.$ref, rootSchema) : schema;\n    return hasType(resolvedSchema, 'object')\n  })\n);\n\n/**\n * Tests whether the given UI schema is of type Control and if the schema\n * is an array of objects.\n * @type {Tester}\n */\nexport const isObjectArrayControl = and(uiTypeIs('Control'), isObjectArray);\n\nconst traverse = (\n  any: JsonSchema | JsonSchema[],\n  pred: (obj: JsonSchema) => boolean,\n  rootSchema: JsonSchema\n): boolean => {\n  if (isArray(any)) {\n    return reduce(any, (acc, el) => acc || traverse(el, pred, rootSchema), false);\n  }\n\n  if (pred(any)) {\n    return true;\n  }\n\n  if (any.$ref) {\n    const toTraverse = resolveSchema(rootSchema, any.$ref, rootSchema);\n    if (toTraverse && !toTraverse.$ref) {\n      return traverse(toTraverse, pred, rootSchema);\n    }\n  }\n\n  if (any.items) {\n    return traverse(any.items, pred, rootSchema);\n  }\n  if (any.properties) {\n    return reduce(\n      toPairs(any.properties),\n      (acc, [_key, val]) => acc || traverse(val, pred, rootSchema),\n      false\n    );\n  }\n\n  return false;\n};\n\nexport const isObjectArrayWithNesting = (\n  uischema: UISchemaElement,\n  schema: JsonSchema,\n  context: TesterContext\n): boolean => {\n  if (!uiTypeIs('Control')(uischema, schema, context)) {\n    return false;\n  }\n  const schemaPath = (uischema as ControlElement).scope;\n  const resolvedSchema = resolveSchema(schema, schemaPath, context?.rootSchema ?? schema);\n  let objectDepth = 0;\n  if (resolvedSchema !== undefined && resolvedSchema.items !== undefined) {\n    // check if nested arrays\n    if (\n      traverse(resolvedSchema.items, val => {\n        if (val === schema) {\n          return false;\n        }\n        if (val.$ref !== undefined) {\n          return false;\n        }\n        if (val.anyOf || val.oneOf) {\n          return true;\n        }\n        if (hasType(val, 'object')) {\n          objectDepth++;\n          if (objectDepth === 2) {\n            return true;\n          }\n        }\n        if (hasType(val, 'array')) {\n          return true;\n        }\n        return false;\n      }, context?.rootSchema)\n    ) {\n      return true;\n    }\n    // check if uischema options detail is set\n    if (uischema.options && uischema.options.detail) {\n      if (typeof uischema.options.detail === 'string') {\n        return uischema.options.detail.toUpperCase() !== 'DEFAULT';\n      } else if (\n        typeof uischema.options.detail === 'object' &&\n        uischema.options.detail.type\n      ) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n/**\n * Synonym for isObjectArrayControl\n */\nexport const isArrayObjectControl = isObjectArrayControl;\n\n/**\n * Tests whether the given UI schema is of type Control and if the schema\n * is an array of a primitive type.\n * @type {Tester}\n */\nexport const isPrimitiveArrayControl = and(\n  uiTypeIs('Control'),\n  schemaMatches(\n    (schema, rootSchema) =>\n      deriveTypes(schema).length !== 0 &&\n      !Array.isArray(resolveSchema(schema, 'items', rootSchema)) // we don't care about tuples\n  ),\n  schemaSubPathMatches('items', (schema, rootSchema) => {\n    const resolvedSchema = schema.$ref ? resolveSchema(rootSchema, schema.$ref, rootSchema) : schema;\n    const types = deriveTypes(resolvedSchema);\n    return (\n      types.length === 1 &&\n      includes(['integer', 'number', 'boolean', 'string'], types[0])\n    );\n  })\n);\n\n/**\n * Tests whether a given UI schema is of type Control,\n * if the schema is of type number or integer and\n * whether the schema defines a numerical range with a default value.\n * @type {Tester}\n */\nexport const isRangeControl = and(\n  uiTypeIs('Control'),\n  or(schemaTypeIs('number'), schemaTypeIs('integer')),\n  schemaMatches(\n    schema =>\n      schema.hasOwnProperty('maximum') &&\n      schema.hasOwnProperty('minimum') &&\n      schema.hasOwnProperty('default')\n  ),\n  optionIs('slider', true)\n);\n\n/**\n * Tests whether the given UI schema is of type Control, if the schema\n * is of type integer and has option format\n * @type {Tester}\n */\nexport const isNumberFormatControl = and(\n  uiTypeIs('Control'),\n  schemaTypeIs('integer'),\n  optionIs('format', true)\n);\n\nexport const isCategorization = (\n  category: UISchemaElement\n): category is Categorization => category.type === 'Categorization';\n\nexport const isCategory = (uischema: UISchemaElement): boolean =>\n  uischema.type === 'Category';\n\nexport const hasCategory = (categorization: Categorization): boolean => {\n  if (isEmpty(categorization.elements)) {\n    return false;\n  }\n  // all children of the categorization have to be categories\n  return categorization.elements\n    .map(elem =>\n      isCategorization(elem) ? hasCategory(elem) : isCategory(elem)\n    )\n    .reduce((prev, curr) => prev && curr, true);\n};\n\nexport const categorizationHasCategory = (uischema: UISchemaElement) =>\n  hasCategory(uischema as Categorization);\n\nexport const not = (tester: Tester): Tester => (\n  uischema: UISchemaElement,\n  schema: JsonSchema,\n  context: TesterContext\n\n) => !tester(uischema, schema, context);\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport maxBy from 'lodash/maxBy';\nimport remove from 'lodash/remove';\nimport { ADD_UI_SCHEMA, REMOVE_UI_SCHEMA, UISchemaActions } from '../actions';\nimport { NOT_APPLICABLE } from '../testers';\nimport { JsonSchema, UISchemaElement } from '../models';\nimport { Reducer } from '../util';\n\nexport type UISchemaTester = (\n  schema: JsonSchema,\n  schemaPath: string,\n  path: string\n) => number;\n\nexport interface JsonFormsUISchemaRegistryEntry {\n  tester: UISchemaTester;\n  uischema: UISchemaElement;\n}\n\nexport const uischemaRegistryReducer: Reducer<JsonFormsUISchemaRegistryEntry[], UISchemaActions> = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case ADD_UI_SCHEMA:\n      return state\n        .slice()\n        .concat({ tester: action.tester, uischema: action.uischema });\n    case REMOVE_UI_SCHEMA:\n      const copy = state.slice();\n      remove(copy, entry => entry.tester === action.tester);\n      return copy;\n    default:\n      return state;\n  }\n};\n\nexport const findMatchingUISchema = (\n  state: JsonFormsUISchemaRegistryEntry[]\n) => (\n  jsonSchema: JsonSchema,\n  schemaPath: string,\n  path: string\n): UISchemaElement => {\n  const match = maxBy(state, entry =>\n    entry.tester(jsonSchema, schemaPath, path)\n  );\n  if (\n    match !== undefined &&\n    match.tester(jsonSchema, schemaPath, path) !== NOT_APPLICABLE\n  ) {\n    return match.uischema;\n  }\n  return undefined;\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { ControlElement, UISchemaElement } from '../models';\nimport {\n  coreReducer,\n  errorAt,\n  subErrorsAt,\n} from './core';\nimport { defaultDataReducer } from './default-data';\nimport { rendererReducer } from './renderers';\nimport { JsonFormsState } from '../store';\nimport type { JsonFormsUISchemaRegistryEntry } from './uischemas';\nimport {\n  findMatchingUISchema,\n  uischemaRegistryReducer,\n} from './uischemas';\nimport {\n  fetchErrorTranslator,\n  fetchLocale,\n  i18nReducer,\n} from './i18n';\n\nimport { Generate } from '../generators';\nimport { JsonSchema } from '../models/jsonSchema';\n\nimport { cellReducer } from './cells';\nimport { configReducer } from './config';\nimport get from 'lodash/get';\nimport { fetchTranslator } from '.';\nimport { ErrorTranslator, Translator } from '../i18n';\n\nexport const jsonFormsReducerConfig = {\n  core: coreReducer,\n  renderers: rendererReducer,\n  cells: cellReducer,\n  config: configReducer,\n  uischemas: uischemaRegistryReducer,\n  defaultData: defaultDataReducer,\n  i18n: i18nReducer,\n};\n\n/**\n * Finds a registered UI schema to use, if any.\n * @param schema the JSON schema describing the data to be rendered\n * @param schemaPath the according schema path\n * @param path the instance path\n * @param fallback the type of the layout to use or a UI-schema-generator function\n * @param control may be checked for embedded inline uischema options\n */\nexport const findUISchema = (\n  uischemas: JsonFormsUISchemaRegistryEntry[],\n  schema: JsonSchema,\n  schemaPath: string,\n  path: string,\n  fallback: string | (() => UISchemaElement) = 'VerticalLayout',\n  control?: ControlElement,\n  rootSchema?: JsonSchema\n): UISchemaElement => {\n  // handle options\n  if (control && control.options && control.options.detail) {\n    if (typeof control.options.detail === 'string') {\n      if (control.options.detail.toUpperCase() === 'GENERATE') {\n        //use fallback generation function\n        if(typeof fallback === \"function\"){\n          return fallback();\n        }\n        // force generation of uischema\n        return Generate.uiSchema(schema, fallback);\n      }\n    } else if (typeof control.options.detail === 'object') {\n      // check if detail is a valid uischema\n      if (\n        control.options.detail.type &&\n        typeof control.options.detail.type === 'string'\n      ) {\n        return control.options.detail as UISchemaElement;\n      }\n    }\n  }\n  // default\n  const uiSchema = findMatchingUISchema(uischemas)(schema, schemaPath, path);\n  if (uiSchema === undefined) {\n    //use fallback generation function\n    if(typeof fallback === 'function'){\n      return fallback();\n    }\n    return Generate.uiSchema(schema, fallback, '#', rootSchema);\n  }\n  return uiSchema;\n};\n\nexport const getErrorAt = (instancePath: string, schema: JsonSchema) => (\n  state: JsonFormsState\n) => {\n  return errorAt(instancePath, schema)(state.jsonforms.core);\n};\n\nexport const getSubErrorsAt = (instancePath: string, schema: JsonSchema) => (\n  state: JsonFormsState\n) => subErrorsAt(instancePath, schema)(state.jsonforms.core);\n\nexport const getConfig = (state: JsonFormsState) => state.jsonforms.config;\n\nexport const getLocale = (state: JsonFormsState) =>\n  fetchLocale(get(state, 'jsonforms.i18n'));\n\nexport const getTranslator = () => (\n  state: JsonFormsState\n): Translator => fetchTranslator(get(state, 'jsonforms.i18n'));\n\nexport const getErrorTranslator = () => (\n  state: JsonFormsState\n): ErrorTranslator => fetchErrorTranslator(get(state, 'jsonforms.i18n'));\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport get from 'lodash/get';\nimport Ajv from 'ajv';\nimport { JsonFormsState } from '../store';\nimport { JsonSchema, UISchemaElement } from '../models';\nimport {\n  extractAjv,\n  extractData,\n  extractSchema,\n  extractUiSchema,\n} from './core';\nimport {\n  extractDefaultData,\n  JsonFormsDefaultDataRegistryEntry\n} from './default-data';\nimport { JsonFormsRendererRegistryEntry } from './renderers';\nimport { JsonFormsCellRendererRegistryEntry } from './cells';\nimport { JsonFormsUISchemaRegistryEntry } from './uischemas';\n\nexport const getData = (state: JsonFormsState) =>\n  extractData(get(state, 'jsonforms.core'));\nexport const getSchema = (state: JsonFormsState): JsonSchema =>\n  extractSchema(get(state, 'jsonforms.core'));\nexport const getUiSchema = (state: JsonFormsState): UISchemaElement =>\n  extractUiSchema(get(state, 'jsonforms.core'));\nexport const getAjv = (\n  state: JsonFormsState\n): Ajv => extractAjv(get(state, 'jsonforms.core'));\nexport const getDefaultData = (\n  state: JsonFormsState\n): JsonFormsDefaultDataRegistryEntry[] =>\n  extractDefaultData(get(state, 'jsonforms.defaultData'));\nexport const getRenderers = (\n  state: JsonFormsState\n): JsonFormsRendererRegistryEntry[] => get(state, 'jsonforms.renderers');\nexport const getCells = (\n  state: JsonFormsState\n): JsonFormsCellRendererRegistryEntry[] => get(state, 'jsonforms.cells');\nexport const getUISchemas = (\n  state: JsonFormsState\n): JsonFormsUISchemaRegistryEntry[] => get(state, 'jsonforms.uischemas')\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport isEmpty from 'lodash/isEmpty';\nimport range from 'lodash/range';\nimport { isScoped, Scopable } from '../models';\n\nexport const compose = (path1: string, path2: string) => {\n  let p1 = path1;\n  if (!isEmpty(path1) && !isEmpty(path2) && !path2.startsWith('[')) {\n    p1 = path1 + '.';\n  }\n\n  if (isEmpty(p1)) {\n    return path2;\n  } else if (isEmpty(path2)) {\n    return p1;\n  } else {\n    return `${p1}${path2}`;\n  }\n};\n\nexport { compose as composePaths };\n\n/**\n * Convert a schema path (i.e. JSON pointer) to an array by splitting\n * at the '/' character and removing all schema-specific keywords.\n *\n * The returned value can be used to de-reference a root object by folding over it\n * and de-referencing the single segments to obtain a new object.\n *\n *\n * @param {string} schemaPath the schema path to be converted\n * @returns {string[]} an array containing only non-schema-specific segments\n */\nexport const toDataPathSegments = (schemaPath: string): string[] => {\n  const s = schemaPath\n    .replace(/(anyOf|allOf|oneOf)\\/[\\d]\\//g, '')\n    .replace(/(then|else)\\//g, '');\n  const segments = s.split('/');\n\n  const decodedSegments = segments.map(decode);\n\n  const startFromRoot = decodedSegments[0] === '#' || decodedSegments[0] === '';\n  const startIndex = startFromRoot ? 2 : 1;\n  return range(startIndex, decodedSegments.length, 2).map(idx => decodedSegments[idx]);\n};\n\n/**\n * Remove all schema-specific keywords (e.g. 'properties') from a given path.\n * @example\n * toDataPath('#/properties/foo/properties/bar') === '#/foo/bar')\n *\n * @param {string} schemaPath the schema path to be converted\n * @returns {string} the path without schema-specific keywords\n */\nexport const toDataPath = (schemaPath: string): string => {\n  return toDataPathSegments(schemaPath).join('.');\n    };\n\nexport const composeWithUi = (scopableUi: Scopable, path: string): string => {\n  if (!isScoped(scopableUi)) {\n    return path ?? '';\n  }\n\n  const segments = toDataPathSegments(scopableUi.scope);\n\n  if (isEmpty(segments)) {\n    return path ?? '';\n  }\n\n  return compose(path, segments.join('.'));\n};\n\n/**\n * Encodes the given segment to be used as part of a JSON Pointer\n * \n * JSON Pointer has special meaning for \"/\" and \"~\", therefore these must be encoded\n */\nexport const encode = (segment: string) => segment?.replace(/~/g, '~0').replace(/\\//g, '~1');\n/**\n * Decodes a given JSON Pointer segment to its \"normal\" representation\n */\nexport const decode = (pointerSegment: string) => pointerSegment?.replace(/~1/g, '/').replace(/~0/, '~');\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport isEmpty from 'lodash/isEmpty';\nimport get from 'lodash/get';\nimport { JsonSchema, JsonSchema7 } from '../models';\nimport { decode } from './path';\n\n/**\n * Map for storing refs and the respective schemas they are pointing to.\n */\nexport interface ReferenceSchemaMap {\n  [ref: string]: JsonSchema;\n}\n\nconst isObjectSchema = (schema: JsonSchema): boolean => {\n  return schema.properties !== undefined;\n};\nconst isArraySchema = (schema: JsonSchema): boolean => {\n  return schema.type === 'array' && schema.items !== undefined;\n};\n\nexport const resolveData = (instance: any, dataPath: string): any => {\n  if (isEmpty(dataPath)) {\n    return instance;\n  }\n  const dataPathSegments = dataPath.split('.');\n\n  return dataPathSegments\n    .map(segment => decodeURIComponent(segment))\n    .reduce((curInstance, decodedSegment) => {\n      if (!curInstance || !curInstance.hasOwnProperty(decodedSegment)) {\n        return undefined;\n      }\n\n      return curInstance[decodedSegment];\n    }, instance);\n};\n\n/**\n * Finds all references inside the given schema.\n *\n * @param schema The {@link JsonSchema} to find the references in\n * @param result The initial result map, default: empty map (this parameter is used for recursion\n *               inside the function)\n * @param resolveTuples Whether arrays of tuples should be considered; default: false\n */\nexport const findAllRefs = (\n  schema: JsonSchema,\n  result: ReferenceSchemaMap = {},\n  resolveTuples = false\n): ReferenceSchemaMap => {\n  if (isObjectSchema(schema)) {\n    Object.keys(schema.properties).forEach(key =>\n      findAllRefs(schema.properties[key], result)\n    );\n  }\n  if (isArraySchema(schema)) {\n    if (Array.isArray(schema.items)) {\n      if (resolveTuples) {\n        const items: JsonSchema[] = schema.items;\n        items.forEach(child => findAllRefs(child, result));\n      }\n    } else {\n      findAllRefs(schema.items, result);\n    }\n  }\n  if (Array.isArray(schema.anyOf)) {\n    const anyOf: JsonSchema[] = schema.anyOf;\n    anyOf.forEach(child => findAllRefs(child, result));\n  }\n  if (schema.$ref !== undefined) {\n    result[schema.$ref] = schema;\n  }\n\n  return result;\n};\n\nconst invalidSegment = (pathSegment: string) =>\n  pathSegment === '#' || pathSegment === undefined || pathSegment === '';\n\n/**\n * Resolve the given schema path in order to obtain a subschema.\n * @param {JsonSchema} schema the root schema from which to start\n * @param {string} schemaPath the schema path to be resolved\n * @param {JsonSchema} rootSchema the actual root schema\n * @returns {JsonSchema} the resolved sub-schema\n */\nexport const resolveSchema = (\n  schema: JsonSchema,\n  schemaPath: string,\n  rootSchema: JsonSchema\n): JsonSchema => {\n  const segments = schemaPath?.split('/').map(decode);\n  return resolveSchemaWithSegments(schema, segments, rootSchema);\n};\n\nconst resolveSchemaWithSegments = (\n  schema: JsonSchema,\n  pathSegments: string[],\n  rootSchema: JsonSchema\n): JsonSchema => {\n  if (isEmpty(schema)) {\n    return undefined;\n  }\n\n  if (schema.$ref) {\n    schema = resolveSchema(rootSchema, schema.$ref, rootSchema);\n  }\n\n  if (!pathSegments || pathSegments.length === 0) {\n    return schema;\n  }\n\n  const [segment, ...remainingSegments] = pathSegments;\n\n  if (invalidSegment(segment)) {\n    return resolveSchemaWithSegments(schema, remainingSegments, rootSchema);\n  }\n\n  const singleSegmentResolveSchema = get(schema, segment);\n\n  const resolvedSchema = resolveSchemaWithSegments(singleSegmentResolveSchema, remainingSegments, rootSchema);\n  if (resolvedSchema) {\n    return resolvedSchema;\n  }\n\n  if (segment === 'properties' || segment === 'items') {\n    // Let's try to resolve the path, assuming oneOf/allOf/anyOf/then/else was omitted.\n    // We only do this when traversing an object or array as we want to avoid\n    // following a property which is named oneOf, allOf, anyOf, then or else.\n    let alternativeResolveResult = undefined;\n\n    const subSchemas = [].concat(\n      schema.oneOf ?? [],\n      schema.allOf ?? [],\n      schema.anyOf ?? [],\n      (schema as JsonSchema7).then ?? [],\n      (schema as JsonSchema7).else ?? []\n    );\n\n    for (const subSchema of subSchemas) {\n      alternativeResolveResult = resolveSchemaWithSegments(\n        subSchema,\n        [segment, ...remainingSegments],\n        rootSchema\n      );\n      if (alternativeResolveResult) {\n        break;\n      }\n    }\n    return alternativeResolveResult;\n  }\n\n  return undefined;\n}","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport has from 'lodash/has';\nimport {\n  AndCondition,\n  Condition,\n  JsonSchema,\n  LeafCondition,\n  OrCondition,\n  RuleEffect,\n  SchemaBasedCondition,\n  Scopable,\n  UISchemaElement\n} from '../models';\nimport { resolveData } from './resolvers';\nimport { composeWithUi } from './path';\nimport Ajv from 'ajv';\nimport { getAjv } from '../reducers';\nimport { JsonFormsState } from '../store';\n\nconst isOrCondition = (condition: Condition): condition is OrCondition =>\n  condition.type === 'OR';\n\nconst isAndCondition = (condition: Condition): condition is AndCondition =>\n  condition.type === 'AND';\n\nconst isLeafCondition = (condition: Condition): condition is LeafCondition =>\n  condition.type === 'LEAF';\n\nconst isSchemaCondition = (\n  condition: Condition\n): condition is SchemaBasedCondition => has(condition, 'schema');\n\nconst getConditionScope = (condition: Scopable, path: string): string => {\n  return composeWithUi(condition, path);\n};\n\nconst evaluateCondition = (\n  data: any,\n  condition: Condition,\n  path: string,\n  ajv: Ajv\n): boolean => {\n  if (isAndCondition(condition)) {\n    return condition.conditions.reduce(\n      (acc, cur) => acc && evaluateCondition(data, cur, path, ajv),\n      true\n    );\n  } else if (isOrCondition(condition)) {\n    return condition.conditions.reduce(\n      (acc, cur) => acc || evaluateCondition(data, cur, path, ajv),\n      false\n    );\n  } else if (isLeafCondition(condition)) {\n    const value = resolveData(data, getConditionScope(condition, path));\n    return value === condition.expectedValue;\n  } else if (isSchemaCondition(condition)) {\n    const value = resolveData(data, getConditionScope(condition, path));\n    return ajv.validate(condition.schema, value) as boolean;\n  } else {\n    // unknown condition\n    return true;\n  }\n};\n\nconst isRuleFulfilled = (\n  uischema: UISchemaElement,\n  data: any,\n  path: string,\n  ajv: Ajv\n): boolean => {\n  const condition = uischema.rule.condition;\n  return evaluateCondition(data, condition, path, ajv);\n};\n\nexport const evalVisibility = (\n  uischema: UISchemaElement,\n  data: any,\n  path: string = undefined,\n  ajv: Ajv\n): boolean => {\n  const fulfilled = isRuleFulfilled(uischema, data, path, ajv);\n\n  switch (uischema.rule.effect) {\n    case RuleEffect.HIDE:\n      return !fulfilled;\n    case RuleEffect.SHOW:\n      return fulfilled;\n    // visible by default\n    default:\n      return true;\n  }\n};\n\nexport const evalEnablement = (\n  uischema: UISchemaElement,\n  data: any,\n  path: string = undefined,\n  ajv: Ajv\n): boolean => {\n  const fulfilled = isRuleFulfilled(uischema, data, path, ajv);\n\n  switch (uischema.rule.effect) {\n    case RuleEffect.DISABLE:\n      return !fulfilled;\n    case RuleEffect.ENABLE:\n      return fulfilled;\n    // enabled by default\n    default:\n      return true;\n  }\n};\n\nexport const hasShowRule = (uischema: UISchemaElement): boolean => {\n  if (\n    uischema.rule &&\n    (uischema.rule.effect === RuleEffect.SHOW ||\n      uischema.rule.effect === RuleEffect.HIDE)\n  ) {\n    return true;\n  }\n  return false;\n};\n\nexport const hasEnableRule = (uischema: UISchemaElement): boolean => {\n  if (\n    uischema.rule &&\n    (uischema.rule.effect === RuleEffect.ENABLE ||\n      uischema.rule.effect === RuleEffect.DISABLE)\n  ) {\n    return true;\n  }\n  return false;\n};\n\nexport const isVisible = (\n  uischema: UISchemaElement,\n  data: any,\n  path: string = undefined,\n  ajv: Ajv\n): boolean => {\n  if (uischema.rule) {\n    return evalVisibility(uischema, data, path, ajv);\n  }\n\n  return true;\n};\n\nexport const isEnabled = (\n  uischema: UISchemaElement,\n  data: any,\n  path: string = undefined,\n  ajv: Ajv\n): boolean => {\n  if (uischema.rule) {\n    return evalEnablement(uischema, data, path, ajv);\n  }\n\n  return true;\n};\n\n/**\n * Indicates whether the given `uischema` element shall be enabled or disabled.\n * Checks the global readonly flag, uischema rule, uischema options (including the config),\n * the schema and the enablement indicator of the parent.\n */\nexport const isInherentlyEnabled = (\n  state: JsonFormsState,\n  ownProps: any,\n  uischema: UISchemaElement,\n  schema: JsonSchema & { readOnly?: boolean } | undefined,\n  rootData: any,\n  config: any\n) => {\n  if (state?.jsonforms?.readonly) {\n    return false;\n  }\n  if (uischema && hasEnableRule(uischema)) {\n    return isEnabled(uischema, rootData, ownProps?.path, getAjv(state));\n  }\n  if (typeof uischema?.options?.readonly === 'boolean') {\n    return !uischema.options.readonly;\n  }\n  if (typeof uischema?.options?.readOnly === 'boolean') {\n    return !uischema.options.readOnly;\n  }\n  if (typeof config?.readonly === 'boolean') {\n    return !config.readonly;\n  }\n  if (typeof config?.readOnly === 'boolean') {\n    return !config.readOnly;\n  }\n  if (schema?.readOnly === true) {\n    return false;\n  }\n  if (typeof ownProps?.enabled === 'boolean') {\n    return ownProps.enabled;\n  }\n  return true;\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport isEmpty from 'lodash/isEmpty';\nimport isArray from 'lodash/isArray';\nimport includes from 'lodash/includes';\nimport find from 'lodash/find';\nimport { JsonSchema, Scoped, UISchemaElement } from '..';\nimport { resolveData, resolveSchema } from './resolvers';\nimport { composePaths, toDataPathSegments } from './path';\nimport { isEnabled, isVisible } from './runtime';\nimport Ajv from 'ajv';\n\n/**\n * Escape the given string such that it can be used as a class name,\n * i.e. hashes and slashes will be replaced.\n *\n * @param {string} s the string that should be converted to a valid class name\n * @returns {string} the escaped string\n */\nexport const convertToValidClassName = (s: string): string =>\ns.replace('#', 'root').replace(new RegExp('/', 'g'), '_');\n\nexport const formatErrorMessage = (errors: string[]) => {\n if (errors === undefined || errors === null) {\n   return '';\n }\n\n return errors.join('\\n');\n};\n\nexport const hasType = (jsonSchema: JsonSchema, expected: string): boolean => {\n return includes(deriveTypes(jsonSchema), expected);\n};\n\n/**\n * Derives the type of the jsonSchema element\n */\nexport const deriveTypes = (jsonSchema: JsonSchema): string[] => {\n if (isEmpty(jsonSchema)) {\n   return [];\n }\n if (!isEmpty(jsonSchema.type) && typeof jsonSchema.type === 'string') {\n   return [jsonSchema.type];\n }\n if (isArray(jsonSchema.type)) {\n   return jsonSchema.type;\n }\n if (\n   !isEmpty(jsonSchema.properties) ||\n   !isEmpty(jsonSchema.additionalProperties)\n ) {\n   return ['object'];\n }\n if (!isEmpty(jsonSchema.items)) {\n   return ['array'];\n }\n\n if (!isEmpty(jsonSchema.allOf)) {\n   const allOfType = find(\n     jsonSchema.allOf,\n     (schema: JsonSchema) => deriveTypes(schema).length !== 0\n   );\n\n   if (allOfType) {\n     return deriveTypes(allOfType);\n   }\n }\n // ignore all remaining cases\n return [];\n};\n\n/**\n * Convenience wrapper around resolveData and resolveSchema.\n */\nexport const Resolve: {\n schema(\n   schema: JsonSchema,\n   schemaPath: string,\n   rootSchema: JsonSchema\n ): JsonSchema;\n data(data: any, path: string): any;\n} = {\n schema: resolveSchema,\n data: resolveData\n};\n\n// Paths --\nconst fromScoped = (scopable: Scoped): string =>\n toDataPathSegments(scopable.scope).join('.');\n\nexport const Paths = {\n compose: composePaths,\n fromScoped\n};\n\n// Runtime --\nexport const Runtime = {\n isEnabled(uischema: UISchemaElement, data: any, ajv: Ajv): boolean {\n   return isEnabled(uischema, data, undefined, ajv);\n },\n isVisible(uischema: UISchemaElement, data: any, ajv: Ajv): boolean {\n   return isVisible(uischema, data, undefined, ajv);\n }\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport startCase from 'lodash/startCase';\n\nimport { ControlElement, JsonSchema, LabelDescription } from '../models';\nimport { decode } from './path';\n\nconst deriveLabel = (\n  controlElement: ControlElement,\n  schemaElement?: JsonSchema\n): string => {\n  if (schemaElement && typeof schemaElement.title === 'string') {\n    return schemaElement.title;\n  }\n  if (typeof controlElement.scope === 'string') {\n    const ref = controlElement.scope;\n    const label = decode(ref.substr(ref.lastIndexOf('/') + 1));\n    return startCase(label);\n  }\n\n  return '';\n};\n\nexport const createCleanLabel = (label: string): string => {\n  return startCase(label.replace('_', ' '));\n};\n\n/**\n * Return a label object based on the given control and schema element.\n * @param {ControlElement} withLabel the UI schema to obtain a label object for\n * @param {JsonSchema} schema optional: the corresponding schema element\n * @returns {LabelDescription}\n */\nexport const createLabelDescriptionFrom = (\n  withLabel: ControlElement,\n  schema?: JsonSchema\n): LabelDescription => {\n  const labelProperty = withLabel.label;\n  if (typeof labelProperty === 'boolean') {\n    return labelDescription(deriveLabel(withLabel, schema), labelProperty);\n  }\n  if (typeof labelProperty === 'string') {\n    return labelDescription(labelProperty, true);\n  }\n  if (typeof labelProperty === 'object') {\n    const label =\n      typeof labelProperty.text === 'string'\n        ? labelProperty.text\n        : deriveLabel(withLabel, schema);\n    const show =\n      typeof labelProperty.show === 'boolean' ? labelProperty.show : true;\n    return labelDescription(label, show);\n  }\n  return labelDescription(deriveLabel(withLabel, schema), true);\n};\n\nconst labelDescription = (text: string, show: boolean): LabelDescription => ({\n  text: text,\n  show: show\n});\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport get from 'lodash/get';\nimport { ControlElement, isLabelable, JsonSchema, LabelElement, UISchemaElement } from '../models';\nimport find from 'lodash/find';\nimport {\n  getUISchemas,\n  JsonFormsCellRendererRegistryEntry,\n  JsonFormsRendererRegistryEntry,\n} from '../reducers';\nimport {\n  getAjv,\n  getCells,\n  getConfig,\n  getData,\n  getErrorAt,\n  getErrorTranslator,\n  getRenderers,\n  getSchema,\n  getSubErrorsAt,\n  getTranslator,\n  getUiSchema,\n  JsonFormsUISchemaRegistryEntry,\n} from '../reducers';\nimport { RankedTester } from '../testers';\nimport { hasShowRule, isInherentlyEnabled, isVisible } from './runtime';\nimport { createLabelDescriptionFrom } from './label';\nimport { CombinatorKeyword } from './combinators';\nimport { moveDown, moveUp } from './array';\nimport { AnyAction, Dispatch } from './type';\nimport { Resolve } from './util';\nimport { composePaths, composeWithUi } from './path';\nimport { CoreActions, update } from '../actions';\nimport { ErrorObject } from 'ajv';\nimport { JsonFormsState } from '../store';\nimport { deriveLabelForUISchemaElement, getCombinedErrorMessage, getI18nKey, getI18nKeyPrefix, getI18nKeyPrefixBySchema, Translator } from '../i18n';\n\nconst isRequired = (\n  schema: JsonSchema,\n  schemaPath: string,\n  rootSchema: JsonSchema\n): boolean => {\n  const pathSegments = schemaPath.split('/');\n  const lastSegment = pathSegments[pathSegments.length - 1];\n  // Skip \"properties\", \"items\" etc. to resolve the parent\n  const nextHigherSchemaSegments = pathSegments.slice(\n    0,\n    pathSegments.length - 2\n  );\n  const nextHigherSchemaPath = nextHigherSchemaSegments.join('/');\n  const nextHigherSchema = Resolve.schema(\n    schema,\n    nextHigherSchemaPath,\n    rootSchema\n  );\n\n  return (\n    nextHigherSchema !== undefined &&\n    nextHigherSchema.required !== undefined &&\n    nextHigherSchema.required.indexOf(lastSegment) !== -1\n  );\n};\n\n/**\n * Adds an asterisk to the given label string based\n * on the required parameter.\n *\n * @param {string | undefined} label the label string\n * @param {boolean} required whether the label belongs to a control which is required\n * @param {boolean} hideRequiredAsterisk applied UI Schema option\n * @returns {string} the label string\n */\nexport const computeLabel = (\n  label: string | undefined,\n  required: boolean,\n  hideRequiredAsterisk: boolean\n): string => {\n  return `${label ?? ''}${ required && !hideRequiredAsterisk ? '*' : ''}`;\n};\n\n/**\n * Indicates whether to mark a field as required.\n *\n * @param {boolean} required whether the label belongs to a control which is required\n * @param {boolean} hideRequiredAsterisk applied UI Schema option\n * @returns {boolean} should the field be marked as required\n */\n export const showAsRequired = (\n  required: boolean,\n  hideRequiredAsterisk: boolean\n): boolean => {\n  return required && !hideRequiredAsterisk;\n};\n\n/**\n * Create a default value based on the given scheam.\n * @param schema the schema for which to create a default value.\n * @returns {any}\n */\nexport const createDefaultValue = (schema: JsonSchema) => {\n  switch (schema.type) {\n    case 'string':\n      if (\n        schema.format === 'date-time' ||\n        schema.format === 'date' ||\n        schema.format === 'time'\n      ) {\n        return new Date();\n      }\n      return '';\n    case 'integer':\n    case 'number':\n      return 0;\n    case 'boolean':\n      return false;\n    case 'array':\n      return [];\n    case 'null':\n      return null;\n    default:\n      return {};\n  }\n};\n\n/**\n * Whether an element's description should be hidden.\n *\n * @param visible whether an element is visible\n * @param description the element's description\n * @param isFocused whether the element is focused\n *\n * @returns {boolean} true, if the description is to be hidden, false otherwise\n */\nexport const isDescriptionHidden = (\n  visible: boolean,\n  description: string | undefined,\n  isFocused: boolean,\n  showUnfocusedDescription: boolean\n): boolean => {\n  return (\n    description === undefined ||\n    (description !== undefined && !visible) ||\n    (!showUnfocusedDescription && !isFocused)\n  );\n};\n\nexport interface WithClassname {\n  className?: string;\n}\n\nexport interface EnumOption {\n  label: string;\n  value: any;\n}\n\nexport const enumToEnumOptionMapper = (\n  e: any,\n  t?: Translator,\n  i18nKey?: string\n): EnumOption => {\n  let label = typeof e === 'string' ? e : JSON.stringify(e);\n  if (t) {\n    if (i18nKey) {\n      label = t(`${i18nKey}.${label}`, label);\n    } else {\n      label = t(label, label);\n    }\n  }\n  return { label, value: e };\n};\n\nexport const oneOfToEnumOptionMapper = (\n  e: any,\n  t?: Translator,\n  fallbackI18nKey?: string\n): EnumOption => {\n  let label =\n    e.title ??\n    (typeof e.const === 'string' ? e.const : JSON.stringify(e.const));\n  if (t) {\n    // prefer schema keys as they can be more specialized\n    if (e.i18n) {\n      label = t(e.i18n, label);\n    } else if (fallbackI18nKey) {\n      label = t(`${fallbackI18nKey}.${label}`, label);\n    } else {\n      label = t(label, label);\n    }\n  }\n  return {\n    label,\n    value: e.const,\n  };\n};\n\nexport interface OwnPropsOfRenderer {\n  /**\n   * The UI schema to be rendered.\n   */\n  uischema?: UISchemaElement;\n  /**\n   * The JSON schema that describes the data.\n   */\n  schema?: JsonSchema;\n  /**\n   * Whether the rendered element should be enabled.\n   */\n  enabled?: boolean;\n  /**\n   * Whether the rendered element should be visible.\n   */\n  visible?: boolean;\n\n  /**\n   * Optional instance path. Necessary when the actual data\n   * path can not be inferred via the UI schema element as\n   * it is the case with nested controls.\n   */\n  path?: string;\n\n  renderers?: JsonFormsRendererRegistryEntry[];\n\n  cells?: JsonFormsCellRendererRegistryEntry[];\n\n  uischemas?: JsonFormsUISchemaRegistryEntry[];\n}\n\nexport interface OwnPropsOfControl extends OwnPropsOfRenderer {\n  id?: string;\n  // constraint type\n  uischema?: ControlElement;\n}\n\nexport interface OwnPropsOfLabel extends OwnPropsOfRenderer {\n  uischema?: LabelElement;\n}\n\nexport interface OwnPropsOfEnum {\n  options?: EnumOption[];\n}\n\nexport interface OwnPropsOfLayout extends OwnPropsOfRenderer {\n  direction?: 'row' | 'column';\n}\n\n/**\n * State-based props of a {@link Renderer}.\n */\nexport interface StatePropsOfRenderer {\n  /**\n   * Any configuration options for the element.\n   */\n  config?: any;\n\n  /**\n   * The UI schema to be rendered.\n   */\n  uischema: UISchemaElement;\n\n  /**\n   * The JSON schema that describes the data.\n   */\n  schema: JsonSchema;\n\n  /**\n   * The data to be rendered.\n   */\n  data?: any;\n\n  /**\n   * Whether the rendered element should be enabled.\n   */\n  enabled: boolean;\n  /**\n   * Whether the rendered element should be visible.\n   */\n  visible: boolean;\n\n  /**\n   * Instance path the data is written to, in case of a control.\n   */\n  path: string;\n\n  /**\n   * All available renderers.\n   */\n  renderers?: JsonFormsRendererRegistryEntry[];\n\n  /**\n   * All available cell renderers.\n   */\n\n  cells?: JsonFormsCellRendererRegistryEntry[];\n}\n\n/**\n * State-based properties for UI schema elements that have a scope.\n */\nexport interface StatePropsOfScopedRenderer extends StatePropsOfRenderer {\n  // constraint type\n  uischema: ControlElement;\n\n  /**\n   * Any validation errors that are caused by the data to be rendered.\n   */\n  errors: string;\n\n  /**\n   * The data to be rendered.\n   */\n  data: any;\n\n  /**\n   * The root schema as returned by the store.\n   */\n  rootSchema: JsonSchema;\n\n  /**\n   * A unique ID that should be used for rendering the scoped UI schema element.\n   */\n  id: string;\n}\n\n/**\n * Props of a {@link Renderer}.\n */\nexport interface RendererProps extends StatePropsOfRenderer {}\n\n/**\n * State-based props of a Control\n */\nexport interface StatePropsOfControl extends StatePropsOfScopedRenderer {\n  cells?: { tester: RankedTester; cell: any }[];\n\n  /**\n   * The label for the rendered element.\n   */\n  label: string;\n\n  /**\n   * Description of input cell\n   */\n  description?: string;\n\n  /**\n   * Whether the rendered data is required.\n   */\n  required?: boolean;\n\n  // TODO: renderers?\n}\n\n/**\n * Dispatch-based props of a Control.\n */\nexport interface DispatchPropsOfControl {\n  /**\n   * Update handler that emits a data change\n   *\n   * @param {string} path the path to the data to be updated\n   * @param {any} value the new value that should be written to the given path\n   */\n  handleChange(path: string, value: any): void;\n}\n\n/**\n * Props of a Control.\n */\nexport interface ControlProps\n  extends StatePropsOfControl,\n    DispatchPropsOfControl {}\n\n/**\n * State props of a layout;\n */\nexport interface StatePropsOfLayout extends StatePropsOfRenderer {\n  /**\n   * Direction for the layout to flow\n   */\n  direction: 'row' | 'column';\n  label?: string;\n}\n\nexport interface LayoutProps extends StatePropsOfLayout {}\n\n/**\n * The state of a control.\n */\nexport interface ControlState {\n  /**\n   * The current value.\n   */\n  value: any;\n\n  /**\n   * Whether the control is focused.\n   */\n  isFocused: boolean;\n}\n\n/**\n * Map state to control props.\n * @param state the store's state\n * @param ownProps any own props\n * @returns {StatePropsOfControl} state props for a control\n */\nexport const mapStateToControlProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl\n): StatePropsOfControl => {\n  const { uischema } = ownProps;\n  const rootData = getData(state);\n  const path = composeWithUi(uischema, ownProps.path);\n  const visible: boolean =\n    ownProps.visible === undefined || hasShowRule(uischema)\n      ? isVisible(uischema, rootData, ownProps.path, getAjv(state))\n      : ownProps.visible;\n  const controlElement = uischema as ControlElement;\n  const id = ownProps.id;\n  const rootSchema = getSchema(state);\n  const required =\n    controlElement.scope !== undefined &&\n    isRequired(ownProps.schema, controlElement.scope, rootSchema);\n  const resolvedSchema = Resolve.schema(\n    ownProps.schema || rootSchema,\n    controlElement.scope,\n    rootSchema\n  );\n  const errors = getErrorAt(path, resolvedSchema)(state);\n  \n  const description =\n    resolvedSchema !== undefined ? resolvedSchema.description : '';\n  const data = Resolve.data(rootData, path);\n  const labelDesc = createLabelDescriptionFrom(uischema, resolvedSchema);\n  const label = labelDesc.show ? labelDesc.text : '';\n  const config = getConfig(state);\n  const enabled: boolean = isInherentlyEnabled(\n    state,\n    ownProps,\n    uischema,\n    resolvedSchema || rootSchema,\n    rootData,\n    config\n  );\n\n  const schema = resolvedSchema ?? rootSchema;\n  const t = getTranslator()(state);\n  const te = getErrorTranslator()(state);\n  const i18nLabel = t(getI18nKey(schema, uischema, path, 'label'), label, {schema, uischema, path, errors} );\n  const i18nDescription = t(getI18nKey(schema, uischema, path, 'description'), description, {schema, uischema, path, errors});\n  const i18nErrorMessage = getCombinedErrorMessage(errors, te, t, schema, uischema, path);\n\n  return {\n    data,\n    description: i18nDescription,\n    errors: i18nErrorMessage,\n    label: i18nLabel,\n    visible,\n    enabled,\n    id,\n    path,\n    required,\n    uischema,\n    schema,\n    config: getConfig(state),\n    cells: ownProps.cells || state.jsonforms.cells,\n    rootSchema\n  };\n};\n\n/**\n *\n * Map dispatch to control props.\n *\n * @param dispatch the store's dispatch method\n * @returns {DispatchPropsOfControl} dispatch props for a control\n */\nexport const mapDispatchToControlProps = (\n  dispatch: Dispatch<AnyAction>\n): DispatchPropsOfControl => ({\n  handleChange(path, value) {\n    dispatch(update(path, () => value));\n  }\n});\n\n/**\n * Default mapStateToCellProps for enum control. Options is used for populating dropdown list\n * @param state\n * @param ownProps\n * @returns {StatePropsOfControl & OwnPropsOfEnum}\n */\nexport const mapStateToEnumControlProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl & OwnPropsOfEnum\n): StatePropsOfControl & OwnPropsOfEnum => {\n  const props: StatePropsOfControl = mapStateToControlProps(state, ownProps);\n  const options: EnumOption[] =\n    ownProps.options ||\n    props.schema.enum?.map(e =>\n      enumToEnumOptionMapper(\n        e,\n        getTranslator()(state),\n        getI18nKeyPrefix(props.schema, props.uischema, props.path)\n      )\n    ) ||\n    (props.schema.const && [\n      enumToEnumOptionMapper(\n        props.schema.const,\n        getTranslator()(state),\n        getI18nKeyPrefix(props.schema, props.uischema, props.path)\n      )\n    ]);\n  return {\n    ...props,\n    options\n  };\n};\n\n/**\n * Default mapStateToCellProps for enum control based on oneOf. Options is used for populating dropdown list\n * @param state\n * @param ownProps\n * @returns {StatePropsOfControl & OwnPropsOfEnum}\n */\nexport const mapStateToOneOfEnumControlProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl & OwnPropsOfEnum\n): StatePropsOfControl & OwnPropsOfEnum => {\n  const props: StatePropsOfControl = mapStateToControlProps(state, ownProps);\n  const options: EnumOption[] =\n    ownProps.options ||\n    (props.schema.oneOf as JsonSchema[])?.map(oneOfSubSchema =>\n      oneOfToEnumOptionMapper(\n        oneOfSubSchema,\n        getTranslator()(state),\n        getI18nKeyPrefix(props.schema, props.uischema, props.path)\n      )\n    );\n  return {\n    ...props,\n    options\n  };\n};\n\n/**\n * Default mapStateToCellProps for multi enum control. Options is used for populating dropdown list\n * @param state\n * @param ownProps\n * @returns {StatePropsOfControl & OwnPropsOfEnum}\n */\nexport const mapStateToMultiEnumControlProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl & OwnPropsOfEnum\n): StatePropsOfControl & OwnPropsOfEnum => {\n  const props: StatePropsOfControl = mapStateToControlProps(state, ownProps);\n  const items = props.schema.items as JsonSchema;\n  const options: EnumOption[] =\n    ownProps.options ||\n    (items?.oneOf &&\n      (items.oneOf as JsonSchema[]).map(oneOfSubSchema =>\n        oneOfToEnumOptionMapper(\n          oneOfSubSchema,\n          state.jsonforms.i18n?.translate,\n          getI18nKeyPrefix(props.schema, props.uischema, props.path)\n        )\n      )) ||\n    items?.enum?.map(e =>\n      enumToEnumOptionMapper(\n        e,\n        state.jsonforms.i18n?.translate,\n        getI18nKeyPrefix(props.schema, props.uischema, props.path)\n      )\n    );\n  return {\n    ...props,\n    options\n  };\n};\n\n/**\n * Map state to control props.\n * @param state the store's state\n * @param ownProps any own props\n * @returns {StatePropsOfControl} state props for a control\n */\nexport const mapStateToMasterListItemProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfMasterListItem\n): StatePropsOfMasterItem => {\n  const { schema, path, index } = ownProps;\n  const firstPrimitiveProp = schema.properties\n    ? find(Object.keys(schema.properties), propName => {\n        const prop = schema.properties[propName];\n        return (\n          prop.type === 'string' ||\n          prop.type === 'number' ||\n          prop.type === 'integer'\n        );\n      })\n    : undefined;\n  const childPath = composePaths(path, `${index}`);\n  const childData = Resolve.data(getData(state), childPath);\n  const childLabel = firstPrimitiveProp ? childData[firstPrimitiveProp] : '';\n\n  return {\n    ...ownProps,\n    childLabel\n  };\n};\n\n/**\n * State-based props of a table control.\n */\nexport interface StatePropsOfControlWithDetail extends StatePropsOfControl {\n  uischemas?: JsonFormsUISchemaRegistryEntry[];\n  renderers?: JsonFormsRendererRegistryEntry[];\n  cells?: JsonFormsCellRendererRegistryEntry[];\n}\n\nexport interface OwnPropsOfMasterListItem {\n  index: number;\n  selected: boolean;\n  path: string;\n  schema: JsonSchema;\n  handleSelect(index: number): () => void;\n  removeItem(path: string, value: number): () => void;\n}\n\nexport interface StatePropsOfMasterItem extends OwnPropsOfMasterListItem {\n  childLabel: string;\n}\n\n/**\n * Map state to control with detail props\n *\n * @param state the store's state\n * @param ownProps any element's own props\n * @returns {StatePropsOfArrayControl} state props for a table control\n */\nexport const mapStateToControlWithDetailProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl\n): StatePropsOfControlWithDetail => {\n  const { ...props } = mapStateToControlProps(state, ownProps);\n\n  return {\n    ...props,\n    uischemas: state.jsonforms.uischemas\n  };\n};\n\nexport interface ControlWithDetailProps\n  extends StatePropsOfControlWithDetail,\n    DispatchPropsOfControl {}\n\n/**\n * State-based props of a table control.\n */\nexport interface StatePropsOfArrayControl\n  extends StatePropsOfControlWithDetail {\n  childErrors?: ErrorObject[];\n}\n\n/**\n * Map state to table props\n *\n * @param state the store's state\n * @param ownProps any element's own props\n * @returns {StatePropsOfArrayControl} state props for a table control\n */\nexport const mapStateToArrayControlProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl\n): StatePropsOfArrayControl => {\n  const { path, schema, uischema, ...props } = mapStateToControlWithDetailProps(\n    state,\n    ownProps\n  );\n\n  const resolvedSchema = Resolve.schema(schema, 'items', props.rootSchema);\n  const childErrors = getSubErrorsAt(path, resolvedSchema)(state);\n\n  return {\n    ...props,\n    path,\n    uischema,\n    schema: resolvedSchema,\n    childErrors,\n    renderers: ownProps.renderers || getRenderers(state),\n    cells: ownProps.cells || getCells(state)\n  };\n};\n\n/**\n * Dispatch props of a table control\n */\nexport interface DispatchPropsOfArrayControl {\n  addItem(path: string, value: any): () => void;\n  removeItems?(path: string, toDelete: number[]): () => void;\n  moveUp?(path: string, toMove: number): () => void;\n  moveDown?(path: string, toMove: number): () => void;\n}\n\n/**\n * Maps state to dispatch properties of an array control.\n *\n * @param dispatch the store's dispatch method\n * @returns {DispatchPropsOfArrayControl} dispatch props of an array control\n */\nexport const mapDispatchToArrayControlProps = (\n  dispatch: Dispatch<CoreActions>\n): DispatchPropsOfArrayControl => ({\n  addItem: (path: string, value: any) => () => {\n    dispatch(\n      update(path, array => {\n        if (array === undefined || array === null) {\n          return [value];\n        }\n\n        array.push(value);\n        return array;\n      })\n    );\n  },\n  removeItems: (path: string, toDelete: number[]) => () => {\n    dispatch(\n      update(path, array => {\n        toDelete\n          .sort()\n          .reverse()\n          .forEach(s => array.splice(s, 1));\n        return array;\n      })\n    );\n  },\n  moveUp: (path, toMove: number) => () => {\n    dispatch(\n      update(path, array => {\n        moveUp(array, toMove);\n        return array;\n      })\n    );\n  },\n  moveDown: (path, toMove: number) => () => {\n    dispatch(\n      update(path, array => {\n        moveDown(array, toMove);\n        return array;\n      })\n    );\n  }\n});\n\nexport interface DispatchPropsOfMultiEnumControl {\n  addItem: (path: string, value: any) => void;\n  removeItem?: (path: string, toDelete: any) => void;\n}\n\nexport const mapDispatchToMultiEnumProps = (\n  dispatch: Dispatch<CoreActions>\n): DispatchPropsOfMultiEnumControl => ({\n  addItem: (path: string, value: any) => {\n    dispatch(\n      update(path, data => {\n        if (data === undefined || data === null) {\n          return [value];\n        }\n        data.push(value);\n        return data;\n      })\n    );\n  },\n  removeItem: (path: string, toDelete: any) => {\n    dispatch(\n      update(path, data => {\n        const indexInData = data.indexOf(toDelete);\n        data.splice(indexInData, 1);\n        return data;\n      })\n    );\n  }\n});\n\n/**\n * Props of an array control.\n */\nexport interface ArrayControlProps\n  extends StatePropsOfArrayControl,\n    DispatchPropsOfArrayControl {}\n\nexport const layoutDefaultProps: {\n  visible: boolean;\n  enabled: boolean;\n  path: string;\n  direction: 'row' | 'column';\n} = {\n  visible: true,\n  enabled: true,\n  path: '',\n  direction: 'column'\n};\n\nconst getDirection = (uischema: UISchemaElement) => {\n  if (uischema.type === 'HorizontalLayout') {\n    return 'row';\n  }\n  if (uischema.type === 'VerticalLayout') {\n    return 'column';\n  }\n  return layoutDefaultProps.direction;\n};\n\n/**\n * Map state to layout props.\n * @param state JSONForms state tree\n * @param ownProps any own props\n * @returns {StatePropsOfLayout}\n */\nexport const mapStateToLayoutProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfLayout\n): LayoutProps => {\n  const rootData = getData(state);\n  const { uischema } = ownProps;\n  const visible: boolean =\n    ownProps.visible === undefined || hasShowRule(uischema)\n      ? isVisible(ownProps.uischema, rootData, ownProps.path, getAjv(state))\n      : ownProps.visible;\n\n  const data = Resolve.data(rootData, ownProps.path);\n  const config = getConfig(state);\n  const enabled: boolean = isInherentlyEnabled(\n    state,\n    ownProps,\n    uischema,\n    undefined, // layouts have no associated schema\n    rootData,\n    config\n  );\n\n  // some layouts have labels which might need to be translated\n  const t = getTranslator()(state);\n  const label = isLabelable(uischema) ? deriveLabelForUISchemaElement(uischema, t) : undefined;\n\n  return {\n    ...layoutDefaultProps,\n    renderers: ownProps.renderers || getRenderers(state),\n    cells: ownProps.cells || getCells(state),\n    visible,\n    enabled,\n    path: ownProps.path,\n    data,\n    uischema: ownProps.uischema,\n    schema: ownProps.schema,\n    direction: ownProps.direction ?? getDirection(uischema),\n    config,\n    label\n  };\n};\n\nexport type RefResolver = (schema: JsonSchema) => Promise<JsonSchema>;\n\nexport interface OwnPropsOfJsonFormsRenderer extends OwnPropsOfRenderer {}\n\nexport interface StatePropsOfJsonFormsRenderer\n  extends OwnPropsOfJsonFormsRenderer {\n  rootSchema: JsonSchema;\n  config: any;\n}\n\nexport interface JsonFormsProps extends StatePropsOfJsonFormsRenderer {}\n\nexport const mapStateToJsonFormsRendererProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfJsonFormsRenderer\n): StatePropsOfJsonFormsRenderer => {\n  return {\n    renderers: ownProps.renderers || get(state.jsonforms, 'renderers'),\n    cells: ownProps.cells || get(state.jsonforms, 'cells'),\n    schema: ownProps.schema || getSchema(state),\n    rootSchema: getSchema(state),\n    uischema: ownProps.uischema || getUiSchema(state),\n    path: ownProps.path,\n    enabled: ownProps.enabled,\n    config: getConfig(state)\n  };\n};\n\nexport const controlDefaultProps = {\n  ...layoutDefaultProps,\n  errors: [] as string[]\n};\n\nexport interface StatePropsOfCombinator extends StatePropsOfControl {\n  rootSchema: JsonSchema;\n  path: string;\n  id: string;\n  indexOfFittingSchema: number;\n  uischemas: JsonFormsUISchemaRegistryEntry[];\n  data: any;\n}\n\nexport const mapStateToCombinatorRendererProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl,\n  keyword: CombinatorKeyword\n): StatePropsOfCombinator => {\n  const { data, schema, rootSchema, ...props } = mapStateToControlProps(\n    state,\n    ownProps,\n  );\n\n  const ajv = state.jsonforms.core.ajv;\n  const structuralKeywords = [\n    'required',\n    'additionalProperties',\n    'type',\n    'enum',\n    'const'\n  ];\n  const dataIsValid = (errors: ErrorObject[]): boolean => {\n    return (\n      !errors ||\n      errors.length === 0 ||\n      !errors.find(e => structuralKeywords.indexOf(e.keyword) !== -1)\n    );\n  };\n  let indexOfFittingSchema: number;\n  // TODO instead of compiling the combinator subschemas we can compile the original schema\n  // without the combinator alternatives and then revalidate and check the errors for the\n  // element\n  for (let i = 0; i < schema[keyword]?.length; i++) {\n    try {\n      let _schema = schema[keyword][i];\n      if(_schema.$ref){\n        _schema = Resolve.schema( rootSchema, _schema.$ref, rootSchema\n        );\n      }\n      const valFn = ajv.compile(_schema);\n      valFn(data);\n      if (dataIsValid(valFn.errors)) {\n        indexOfFittingSchema = i;\n        break;\n      }\n    } catch (error) {\n      console.debug(\"Combinator subschema is not self contained, can't hand it over to AJV\");\n    }\n  }\n\n  return {\n    data,\n    schema,\n    rootSchema,\n    ...props,\n    indexOfFittingSchema,\n    uischemas: getUISchemas(state)\n  };\n};\n\nexport interface CombinatorRendererProps\n  extends StatePropsOfCombinator,\n    DispatchPropsOfControl {}\n/**\n * Map state to all of renderer props.\n * @param state the store's state\n * @param ownProps any own props\n * @returns {StatePropsOfCombinator} state props for a combinator\n */\nexport const mapStateToAllOfProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl\n): StatePropsOfCombinator =>\n  mapStateToCombinatorRendererProps(state, ownProps, 'allOf');\n\nexport const mapStateToAnyOfProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl\n): StatePropsOfCombinator => {\n  return mapStateToCombinatorRendererProps(state, ownProps, 'anyOf');\n};\n\nexport const mapStateToOneOfProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl\n): StatePropsOfCombinator => {\n  return mapStateToCombinatorRendererProps(state, ownProps, 'oneOf');\n};\n\nexport interface StatePropsOfArrayLayout extends StatePropsOfControlWithDetail {\n  data: number;\n  minItems?: number;\n}\n/**\n * Map state to table props\n *\n * @param state the store's state\n * @param ownProps any element's own props\n * @returns {StatePropsOfArrayControl} state props for a table control\n */\nexport const mapStateToArrayLayoutProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfControl\n): StatePropsOfArrayLayout => {\n  const {\n    path,\n    schema,\n    uischema,\n    errors,\n    ...props\n  } = mapStateToControlWithDetailProps(state, ownProps);\n\n  const resolvedSchema = Resolve.schema(schema, 'items', props.rootSchema);\n\n  // TODO Does not consider 'i18n' keys which are specified in the ui schemas of the sub errors\n  const childErrors = getCombinedErrorMessage(\n    getSubErrorsAt(path, resolvedSchema)(state),\n    getErrorTranslator()(state),\n    getTranslator()(state),\n    undefined,\n    undefined,\n    undefined\n  );\n\n  const allErrors =\n    errors +\n    (errors.length > 0 && childErrors.length > 0 ? '\\n' : '') +\n    childErrors;\n  return {\n    ...props,\n    path,\n    uischema,\n    schema: resolvedSchema,\n    data: props.data ? props.data.length : 0,\n    errors: allErrors,\n    minItems: schema.minItems\n  };\n};\n\n/**\n * Props of an array control.\n */\nexport interface ArrayLayoutProps\n  extends StatePropsOfArrayLayout,\n    DispatchPropsOfArrayControl {}\n\nexport interface StatePropsOfLabel extends StatePropsOfRenderer {\n  text?: string;\n}\nexport interface LabelProps extends StatePropsOfLabel{\n}\n\nexport const mapStateToLabelProps = (\n  state: JsonFormsState,\n  props: OwnPropsOfLabel\n) => {\n  const { uischema } = props;\n\n  const visible: boolean =\n    props.visible === undefined || hasShowRule(uischema)\n      ? isVisible(props.uischema, getData(state), props.path, getAjv(state))\n      : props.visible;\n\n  const text = uischema.text;\n  const t = getTranslator()(state);\n  const i18nKeyPrefix = getI18nKeyPrefixBySchema(undefined, uischema);\n  const i18nKey = i18nKeyPrefix ? `${i18nKeyPrefix}.text` : text ?? '';\n  const i18nText = t(i18nKey, text, { uischema });\n  \n  return {\n    text: i18nText,\n    visible,\n    config: getConfig(state),\n    renderers: props.renderers || getRenderers(state),\n    cells: props.cells || getCells(state),\n  }\n}\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport isEmpty from 'lodash/isEmpty';\nimport union from 'lodash/union';\nimport type { JsonFormsCellRendererRegistryEntry } from '../reducers';\nimport {\n  getAjv,\n  getConfig,\n  getData,\n  getErrorAt,\n  getSchema,\n  getTranslator,\n} from '../reducers';\nimport { AnyAction, Dispatch } from './type';\nimport {\n  formatErrorMessage,\n  Resolve,\n} from './util';\nimport {\n  isInherentlyEnabled,\n  isVisible,\n} from './runtime';\nimport {\n  DispatchPropsOfControl,\n  EnumOption,\n  enumToEnumOptionMapper,\n  mapDispatchToControlProps,\n  oneOfToEnumOptionMapper,\n  OwnPropsOfControl,\n  OwnPropsOfEnum,\n  StatePropsOfScopedRenderer,\n} from './renderer';\nimport { JsonFormsState } from '../store';\nimport { JsonSchema } from '../models';\nimport { getI18nKeyPrefix } from '../i18n';\n\nexport type { JsonFormsCellRendererRegistryEntry };\n\nexport interface OwnPropsOfCell extends OwnPropsOfControl {\n  data?: any;\n}\n\n/**\n * State props of a cell.\n */\nexport interface StatePropsOfCell extends StatePropsOfScopedRenderer {\n  isValid: boolean;\n  rootSchema: JsonSchema;\n}\n\nexport interface OwnPropsOfEnumCell extends OwnPropsOfCell, OwnPropsOfEnum {}\n\n/**\n * State props of a cell for enum cell\n */\nexport interface StatePropsOfEnumCell\n  extends StatePropsOfCell,\n    OwnPropsOfEnum {}\n\n/**\n * Props of an enum cell.\n */\nexport interface EnumCellProps\n  extends StatePropsOfEnumCell,\n    DispatchPropsOfControl {}\n\nexport type DispatchPropsOfCell = DispatchPropsOfControl;\n\n/**\n * Props of a cell.\n */\nexport interface CellProps extends StatePropsOfCell, DispatchPropsOfCell {}\n/**\n * Registers the given cell renderer when a JSON Forms store is created.\n * @param {RankedTester} tester\n * @param cell the cell to be registered\n * @returns {any}\n */\nexport interface DispatchCellStateProps extends StatePropsOfCell {\n  cells?: JsonFormsCellRendererRegistryEntry[];\n}\n\n/**\n * Map state to cell props.\n *\n * @param state JSONForms state tree\n * @param ownProps any own props\n * @returns {StatePropsOfCell} state props of a cell\n */\nexport const mapStateToCellProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfCell\n): StatePropsOfCell => {\n  const { id, schema, path, uischema, renderers, cells } = ownProps;\n  const rootData = getData(state);\n  const visible =\n    ownProps.visible !== undefined\n      ? ownProps.visible\n      : isVisible(uischema, rootData, undefined, getAjv(state));\n\n  const rootSchema = getSchema(state);\n  const config = getConfig(state);\n\n  /* When determining the enabled state of cells we take a shortcut: At the\n   * moment it's only possible to configure enablement and disablement at the\n   * control level. Therefore the renderer using the cell, for example a \n   * table renderer, determines whether a cell is enabled and should hand\n   * over the prop themselves. If that prop was given, we prefer it over\n   * anything else to save evaluation effort (except for the global readonly\n   * flag). For example it would be quite expensive to evaluate the same ui schema\n   * rule again and again for each cell of a table. */\n  let enabled;\n  if (state.jsonforms.readonly === true) {\n    enabled = false;\n  } else if (typeof ownProps.enabled === 'boolean') {\n    enabled = ownProps.enabled;\n  } else {\n    enabled = isInherentlyEnabled(\n      state,\n      ownProps,\n      uischema,\n      schema || rootSchema,\n      rootData,\n      config\n    );\n  }\n\n  const errors = formatErrorMessage(\n    union(getErrorAt(path, schema)(state).map(error => error.message))\n  );\n  const isValid = isEmpty(errors);\n\n  return {\n    data: Resolve.data(rootData, path),\n    visible,\n    enabled,\n    id,\n    path,\n    errors,\n    isValid,\n    schema,\n    uischema,\n    config: getConfig(state),\n    rootSchema,\n    renderers,\n    cells\n  };\n};\n\nexport const mapStateToDispatchCellProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfCell\n): DispatchCellStateProps => {\n  const props: StatePropsOfCell = mapStateToCellProps(state, ownProps);\n  const { renderers, cells, ...otherOwnProps } = ownProps;\n  return {\n    ...props,\n    ...otherOwnProps,\n    cells: cells || state.jsonforms.cells || []\n  };\n};\n\nexport interface DispatchCellProps extends DispatchCellStateProps {}\n\n/**\n * Default mapStateToCellProps for enum cell. Options is used for populating dropdown list\n * @param state\n * @param ownProps\n * @returns {StatePropsOfEnumCell}\n */\nexport const defaultMapStateToEnumCellProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfEnumCell\n): StatePropsOfEnumCell => {\n  const props: StatePropsOfCell = mapStateToCellProps(state, ownProps);\n  const options: EnumOption[] =\n    ownProps.options ||\n    props.schema.enum?.map(e =>\n      enumToEnumOptionMapper(\n        e,\n        getTranslator()(state),\n        getI18nKeyPrefix(props.schema, props.uischema, props.path)\n      )\n    ) ||\n    (props.schema.const && [\n      enumToEnumOptionMapper(\n        props.schema.const,\n        getTranslator()(state),\n        getI18nKeyPrefix(props.schema, props.uischema, props.path)\n      )\n    ]);\n  return {\n    ...props,\n    options\n  };\n};\n\n/**\n * mapStateToOneOfEnumCellProps for one of enum cell. Options is used for populating dropdown list from oneOf\n * @param state\n * @param ownProps\n * @returns {StatePropsOfEnumCell}\n */\nexport const mapStateToOneOfEnumCellProps = (\n  state: JsonFormsState,\n  ownProps: OwnPropsOfEnumCell\n): StatePropsOfEnumCell => {\n  const props: StatePropsOfCell = mapStateToCellProps(state, ownProps);\n  const options: EnumOption[] =\n    ownProps.options ||\n    (props.schema.oneOf as JsonSchema[])?.map(oneOfSubSchema =>\n      oneOfToEnumOptionMapper(\n        oneOfSubSchema,\n        getTranslator()(state),\n        getI18nKeyPrefix(props.schema, props.uischema, props.path)\n      )\n    );\n  return {\n    ...props,\n    options\n  };\n};\n\n\n/**\n * Synonym for mapDispatchToControlProps.\n *\n * @type {(dispatch) => {handleChange(path, value): void}}\n */\nexport const mapDispatchToCellProps: (\n  dispatch: Dispatch<AnyAction>\n) => DispatchPropsOfControl = mapDispatchToControlProps;\n\n/**\n * Default dispatch to control props which can be customized to set handleChange action\n *\n */\nexport const defaultMapDispatchToControlProps =\n  // TODO: ownProps types\n  (dispatch: Dispatch<AnyAction>, ownProps: any): DispatchPropsOfControl => {\n    const { handleChange } = mapDispatchToCellProps(dispatch);\n\n    return {\n      handleChange: ownProps.handleChange || handleChange\n    };\n  };\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { ControlElement, JsonSchema, UISchemaElement } from '../models';\nimport { findUISchema, JsonFormsUISchemaRegistryEntry } from '../reducers';\nimport { Resolve } from './util';\n\nexport interface CombinatorSubSchemaRenderInfo {\n  schema: JsonSchema;\n  uischema: UISchemaElement;\n  label: string;\n}\n\nexport type CombinatorKeyword = 'anyOf' | 'oneOf' | 'allOf';\n\nconst createLabel = (\n  subSchema: JsonSchema,\n  subSchemaIndex: number,\n  keyword: CombinatorKeyword\n): string => {\n  if (subSchema.title) {\n    return subSchema.title;\n  } else {\n    return keyword + '-' + subSchemaIndex;\n  }\n};\n\nexport const createCombinatorRenderInfos = (\n  combinatorSubSchemas: JsonSchema[],\n  rootSchema: JsonSchema,\n  keyword: CombinatorKeyword,\n  control: ControlElement,\n  path: string,\n  uischemas: JsonFormsUISchemaRegistryEntry[]\n): CombinatorSubSchemaRenderInfo[] =>\n  combinatorSubSchemas.map((subSchema, subSchemaIndex) => {\n    const schema = subSchema.$ref ? Resolve.schema(rootSchema, subSchema.$ref, rootSchema) : subSchema;\n    return {\n      schema,\n      uischema: findUISchema(\n        uischemas,\n        schema,\n        control.scope,\n        path,\n        undefined,\n        control,\n        rootSchema\n      ),\n      label: createLabel(subSchema, subSchemaIndex, keyword)\n    }\n  });\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nconst usedIds: Set<string> = new Set<string>();\n\nconst makeId = (idBase: string, iteration: number) =>\n  iteration <= 1 ? idBase : idBase + iteration.toString();\n\nconst isUniqueId = (idBase: string, iteration: number) => {\n  const newID = makeId(idBase, iteration);\n  return !usedIds.has(newID);\n};\n\nexport const createId = (proposedId: string) => {\n  if (proposedId === undefined) {\n    // failsafe to avoid endless loops in error cases\n    proposedId = 'undefined';\n  }\n  let tries = 0;\n  while (!isUniqueId(proposedId, tries)) {\n    tries++;\n  }\n  const newID = makeId(proposedId, tries);\n  usedIds.add(newID);\n  return newID;\n};\n\nexport const removeId = (id: string) => usedIds.delete(id);\n\nexport const clearAllIds = () => usedIds.clear();\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport find from 'lodash/find';\n\nexport const getFirstPrimitiveProp = (schema: any) => {\n  if (schema.properties) {\n    return find(Object.keys(schema.properties), propName => {\n      const prop = schema.properties[propName];\n      return (\n        prop.type === 'string' ||\n        prop.type === 'number' ||\n        prop.type === 'integer'\n      );\n    });\n  }\n  return undefined;\n};\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport isEmpty from 'lodash/isEmpty';\nimport { isLayout, UISchemaElement } from '../models';\n\nexport type IterateCallback = (uischema: UISchemaElement) => void;\n\nconst setReadonlyPropertyValue = (value: boolean): IterateCallback => (\n  child: UISchemaElement\n): void => {\n  if (!child.options) {\n    child.options = {};\n  }\n  child.options.readonly = value;\n};\nexport const setReadonly = (uischema: UISchemaElement): void => {\n  iterateSchema(uischema, setReadonlyPropertyValue(true));\n};\nexport const unsetReadonly = (uischema: UISchemaElement): void => {\n  iterateSchema(uischema, setReadonlyPropertyValue(false));\n};\nexport const iterateSchema = (\n  uischema: UISchemaElement,\n  toApply: IterateCallback\n): void => {\n  if (isEmpty(uischema)) {\n    return;\n  }\n  if (isLayout(uischema)) {\n    uischema.elements.forEach(child => iterateSchema(child, toApply));\n    return;\n  }\n  toApply(uischema);\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\nimport Ajv from 'ajv';\nimport addFormats from 'ajv-formats';\nimport { Options } from 'ajv';\n\nexport const createAjv = (options?: Options) => {\n  const ajv = new Ajv({\n    allErrors: true,\n    verbose: true,\n    strict: false,\n    ...options\n  });\n  addFormats(ajv);\n  return ajv;\n};\n","/*\n  The MIT License\n\n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport isEmpty from 'lodash/isEmpty';\nimport startCase from 'lodash/startCase';\nimport keys from 'lodash/keys';\nimport {\n  ControlElement,\n  isGroup,\n  isLayout,\n  JsonSchema,\n  LabelElement,\n  Layout,\n  UISchemaElement\n} from '../models';\nimport { deriveTypes, encode, resolveSchema } from '../util';\n\n/**\n * Creates a new ILayout.\n * @param layoutType The type of the laoyut\n * @returns the new ILayout\n */\nconst createLayout = (layoutType: string): Layout => ({\n  type: layoutType,\n  elements: []\n});\n\n/**\n * Creates a IControlObject with the given label referencing the given ref\n */\nexport const createControlElement = (ref: string): ControlElement => ({\n  type: 'Control',\n  scope: ref\n});\n\n/**\n * Wraps the given {@code uiSchema} in a Layout if there is none already.\n * @param uischema The ui schema to wrap in a layout.\n * @param layoutType The type of the layout to create.\n * @returns the wrapped uiSchema.\n */\nconst wrapInLayoutIfNecessary = (\n  uischema: UISchemaElement,\n  layoutType: string\n): Layout => {\n  if (!isEmpty(uischema) && !isLayout(uischema)) {\n    const verticalLayout: Layout = createLayout(layoutType);\n    verticalLayout.elements.push(uischema);\n\n    return verticalLayout;\n  }\n\n  return uischema as Layout;\n};\n\n/**\n * Adds the given {@code labelName} to the {@code layout} if it exists\n * @param layout\n *      The layout which is to receive the label\n * @param labelName\n *      The name of the schema\n */\nconst addLabel = (layout: Layout, labelName: string) => {\n  if (!isEmpty(labelName)) {\n    const fixedLabel = startCase(labelName);\n    if (isGroup(layout)) {\n      layout.label = fixedLabel;\n    } else {\n      // add label with name\n      const label: LabelElement = {\n        type: 'Label',\n        text: fixedLabel\n      };\n      layout.elements.push(label);\n    }\n  }\n};\n\n/**\n * Returns whether the given {@code jsonSchema} is a combinator ({@code oneOf}, {@code anyOf}, {@code allOf}) at the root level\n * @param jsonSchema\n *      the schema to check\n */\nconst isCombinator = (jsonSchema: JsonSchema): boolean => {\n  return (\n    !isEmpty(jsonSchema) &&\n    (!isEmpty(jsonSchema.oneOf) ||\n      !isEmpty(jsonSchema.anyOf) ||\n      !isEmpty(jsonSchema.allOf))\n  );\n};\n\nconst generateUISchema = (\n  jsonSchema: JsonSchema,\n  schemaElements: UISchemaElement[],\n  currentRef: string,\n  schemaName: string,\n  layoutType: string,\n  rootSchema?: JsonSchema\n): UISchemaElement => {\n  if (!isEmpty(jsonSchema) && jsonSchema.$ref !== undefined) {\n    return generateUISchema(\n      resolveSchema(rootSchema, jsonSchema.$ref, rootSchema),\n      schemaElements,\n      currentRef,\n      schemaName,\n      layoutType,\n      rootSchema\n    );\n  }\n\n  if (isCombinator(jsonSchema)) {\n    const controlObject: ControlElement = createControlElement(currentRef);\n    schemaElements.push(controlObject);\n\n    return controlObject;\n  }\n\n  const types = deriveTypes(jsonSchema);\n  if (types.length === 0) {\n    return null;\n  }\n\n  if (types.length > 1) {\n    const controlObject: ControlElement = createControlElement(currentRef);\n    schemaElements.push(controlObject);\n    return controlObject;\n  }\n\n  if (currentRef === '#' && types[0] === 'object') {\n    const layout: Layout = createLayout(layoutType);\n    schemaElements.push(layout);\n\n    if (jsonSchema.properties && keys(jsonSchema.properties).length > 1) {\n      addLabel(layout, schemaName);\n    }\n\n    if (!isEmpty(jsonSchema.properties)) {\n      // traverse properties\n      const nextRef: string = currentRef + '/properties';\n      Object.keys(jsonSchema.properties).map(propName => {\n        let value = jsonSchema.properties[propName];\n        const ref = `${nextRef}/${encode(propName)}`;\n        if (value.$ref !== undefined) {\n          value = resolveSchema(rootSchema, value.$ref, rootSchema);\n        }\n        generateUISchema(\n          value,\n          layout.elements,\n          ref,\n          propName,\n          layoutType,\n          rootSchema\n        );\n      });\n    }\n\n    return layout;\n  }\n\n  switch (types[0]) {\n    case 'object': // object items will be handled by the object control itself\n    /* falls through */\n    case 'array': // array items will be handled by the array control itself\n    /* falls through */\n    case 'string':\n    /* falls through */\n    case 'number':\n    /* falls through */\n    case 'integer':\n    /* falls through */\n    case 'boolean':\n      const controlObject: ControlElement = createControlElement(currentRef);\n      schemaElements.push(controlObject);\n\n      return controlObject;\n    default:\n      throw new Error('Unknown type: ' + JSON.stringify(jsonSchema));\n  }\n};\n\n/**\n * Generate a default UI schema.\n * @param {JsonSchema} jsonSchema the JSON schema to generated a UI schema for\n * @param {string} layoutType the desired layout type for the root layout\n *        of the generated UI schema\n */\nexport const generateDefaultUISchema = (\n  jsonSchema: JsonSchema,\n  layoutType = 'VerticalLayout',\n  prefix = '#',\n  rootSchema = jsonSchema\n): UISchemaElement =>\n  wrapInLayoutIfNecessary(\n    generateUISchema(jsonSchema, [], prefix, '', layoutType, rootSchema),\n    layoutType\n  );\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { generateJsonSchema } from './schema';\nimport { createControlElement, generateDefaultUISchema } from './uischema';\nimport { ControlElement, JsonSchema, UISchemaElement } from '../';\n\nexport const Generate: {\n  jsonSchema(instance: Object, options?: any): JsonSchema;\n  uiSchema(\n    jsonSchema: JsonSchema,\n    layoutType?: string,\n    prefix?: string,\n    rootSchema?: JsonSchema\n  ): UISchemaElement;\n  controlElement(ref: string): ControlElement;\n} = {\n  jsonSchema: generateJsonSchema,\n  uiSchema: generateDefaultUISchema,\n  controlElement: createControlElement\n};\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport AJV, { ErrorObject } from 'ajv';\nimport { JsonSchema, UISchemaElement } from '../models';\nimport { generateDefaultUISchema, generateJsonSchema } from '../generators';\n\nimport { RankedTester } from '../testers';\nimport { UISchemaTester, ValidationMode } from '../reducers';\nimport { ErrorTranslator, Translator } from '../i18n';\n\nexport const INIT: 'jsonforms/INIT' = 'jsonforms/INIT';\nexport const UPDATE_CORE: 'jsonforms/UPDATE_CORE' = `jsonforms/UPDATE_CORE`;\nexport const SET_AJV: 'jsonforms/SET_AJV' = 'jsonforms/SET_AJV';\nexport const UPDATE_DATA: 'jsonforms/UPDATE' = 'jsonforms/UPDATE';\nexport const UPDATE_ERRORS: 'jsonforms/UPDATE_ERRORS' =\n  'jsonforms/UPDATE_ERRORS';\nexport const VALIDATE: 'jsonforms/VALIDATE' = 'jsonforms/VALIDATE';\nexport const ADD_RENDERER: 'jsonforms/ADD_RENDERER' = 'jsonforms/ADD_RENDERER';\nexport const REMOVE_RENDERER: 'jsonforms/REMOVE_RENDERER' =\n  'jsonforms/REMOVE_RENDERER';\nexport const ADD_CELL: 'jsonforms/ADD_CELL' = 'jsonforms/ADD_CELL';\nexport const REMOVE_CELL: 'jsonforms/REMOVE_CELL' = 'jsonforms/REMOVE_CELL';\nexport const SET_CONFIG: 'jsonforms/SET_CONFIG' = 'jsonforms/SET_CONFIG';\nexport const ADD_UI_SCHEMA: 'jsonforms/ADD_UI_SCHEMA' = `jsonforms/ADD_UI_SCHEMA`;\nexport const REMOVE_UI_SCHEMA: 'jsonforms/REMOVE_UI_SCHEMA' = `jsonforms/REMOVE_UI_SCHEMA`;\nexport const SET_SCHEMA: 'jsonforms/SET_SCHEMA' = `jsonforms/SET_SCHEMA`;\nexport const SET_UISCHEMA: 'jsonforms/SET_UISCHEMA' = `jsonforms/SET_UISCHEMA`;\nexport const SET_VALIDATION_MODE: 'jsonforms/SET_VALIDATION_MODE' =\n  'jsonforms/SET_VALIDATION_MODE';\n\nexport const SET_LOCALE: 'jsonforms/SET_LOCALE' = `jsonforms/SET_LOCALE`;\nexport const SET_TRANSLATOR: 'jsonforms/SET_TRANSLATOR' =\n  'jsonforms/SET_TRANSLATOR';\nexport const UPDATE_I18N: 'jsonforms/UPDATE_I18N' =\n  'jsonforms/UPDATE_I18N';\n\nexport const ADD_DEFAULT_DATA: 'jsonforms/ADD_DEFAULT_DATA' = `jsonforms/ADD_DEFAULT_DATA`;\nexport const REMOVE_DEFAULT_DATA: 'jsonforms/REMOVE_DEFAULT_DATA' = `jsonforms/REMOVE_DEFAULT_DATA`;\n\nexport type CoreActions =\n  | InitAction\n  | UpdateCoreAction\n  | UpdateAction\n  | UpdateErrorsAction\n  | SetAjvAction\n  | SetSchemaAction\n  | SetUISchemaAction\n  | SetValidationModeAction;\n\nexport interface UpdateAction {\n  type: 'jsonforms/UPDATE';\n  path: string;\n  updater(existingData?: any): any;\n}\n\nexport interface UpdateErrorsAction {\n  type: 'jsonforms/UPDATE_ERRORS';\n  errors: ErrorObject[];\n}\n\nexport interface InitAction {\n  type: 'jsonforms/INIT';\n  data: any;\n  schema: JsonSchema;\n  uischema: UISchemaElement;\n  options?: InitActionOptions | AJV;\n}\n\nexport interface UpdateCoreAction {\n  type: 'jsonforms/UPDATE_CORE';\n  data?: any;\n  schema?: JsonSchema;\n  uischema?: UISchemaElement;\n  options?: InitActionOptions | AJV;\n}\n\nexport interface InitActionOptions {\n  ajv?: AJV;\n  validationMode?: ValidationMode;\n  additionalErrors?: ErrorObject[];\n}\n\nexport interface SetValidationModeAction {\n  type: 'jsonforms/SET_VALIDATION_MODE'\n  validationMode: ValidationMode\n}\n\nexport const init = (\n  data: any,\n  schema: JsonSchema = generateJsonSchema(data),\n  uischema?: UISchemaElement,\n  options?: InitActionOptions | AJV\n) => ({\n  type: INIT,\n  data,\n  schema,\n  uischema:\n    typeof uischema === 'object' ? uischema : generateDefaultUISchema(schema),\n  options\n});\n\nexport const updateCore = (\n  data: any,\n  schema: JsonSchema,\n  uischema?: UISchemaElement,\n  options?: AJV | InitActionOptions\n): UpdateCoreAction => ({\n  type: UPDATE_CORE,\n  data,\n  schema,\n  uischema,\n  options\n});\n\nexport interface RegisterDefaultDataAction {\n  type: 'jsonforms/ADD_DEFAULT_DATA';\n  schemaPath: string;\n  data: any;\n}\n\nexport const registerDefaultData = (schemaPath: string, data: any) => ({\n  type: ADD_DEFAULT_DATA,\n  schemaPath,\n  data\n});\n\nexport interface UnregisterDefaultDataAction {\n  type: 'jsonforms/REMOVE_DEFAULT_DATA';\n  schemaPath: string;\n}\n\nexport const unregisterDefaultData = (schemaPath: string) => ({\n  type: REMOVE_DEFAULT_DATA,\n  schemaPath\n});\n\nexport interface SetAjvAction {\n  type: 'jsonforms/SET_AJV';\n  ajv: AJV;\n}\n\nexport const setAjv = (ajv: AJV) => ({\n  type: SET_AJV,\n  ajv\n});\n\nexport const update = (\n  path: string,\n  updater: (existingData: any) => any\n): UpdateAction => ({\n  type: UPDATE_DATA,\n  path,\n  updater\n});\n\nexport const updateErrors = (errors: ErrorObject[]): UpdateErrorsAction => ({\n  type: UPDATE_ERRORS,\n  errors\n});\n\nexport interface AddRendererAction {\n  type: 'jsonforms/ADD_RENDERER';\n  tester: RankedTester;\n  renderer: any;\n}\n\nexport const registerRenderer = (tester: RankedTester, renderer: any) => ({\n  type: ADD_RENDERER,\n  tester,\n  renderer\n});\n\nexport interface AddCellRendererAction {\n  type: 'jsonforms/ADD_CELL';\n  tester: RankedTester;\n  cell: any;\n}\n\nexport const registerCell = (tester: RankedTester, cell: any) => ({\n  type: ADD_CELL,\n  tester,\n  cell\n});\n\nexport interface RemoveCellRendererAction {\n  type: 'jsonforms/REMOVE_CELL';\n  tester: RankedTester;\n  cell: any;\n}\n\nexport const unregisterCell = (tester: RankedTester, cell: any) => ({\n  type: REMOVE_CELL,\n  tester,\n  cell\n});\n\nexport interface RemoveRendererAction {\n  type: 'jsonforms/REMOVE_RENDERER';\n  tester: RankedTester;\n  renderer: any;\n}\n\nexport const unregisterRenderer = (tester: RankedTester, renderer: any) => ({\n  type: REMOVE_RENDERER,\n  tester,\n  renderer\n});\n\nexport interface SetConfigAction {\n  type: 'jsonforms/SET_CONFIG';\n  config: any;\n}\n\nexport const setConfig = (config: any): SetConfigAction => ({\n  type: SET_CONFIG,\n  config\n});\n\nexport const setValidationMode = (validationMode: ValidationMode): SetValidationModeAction => ({\n  type: SET_VALIDATION_MODE,\n  validationMode\n})\n\nexport type UISchemaActions = AddUISchemaAction | RemoveUISchemaAction;\n\nexport interface AddUISchemaAction {\n  type: 'jsonforms/ADD_UI_SCHEMA';\n  tester: UISchemaTester;\n  uischema: UISchemaElement;\n}\n\nexport const registerUISchema = (\n  tester: UISchemaTester,\n  uischema: UISchemaElement\n): AddUISchemaAction => {\n  return {\n    type: ADD_UI_SCHEMA,\n    tester,\n    uischema\n  };\n};\n\nexport interface RemoveUISchemaAction {\n  type: 'jsonforms/REMOVE_UI_SCHEMA';\n  tester: UISchemaTester;\n}\n\nexport const unregisterUISchema = (\n  tester: UISchemaTester\n): RemoveUISchemaAction => {\n  return {\n    type: REMOVE_UI_SCHEMA,\n    tester\n  };\n};\n\nexport type I18nActions =\n  | SetLocaleAction\n  | SetTranslatorAction\n  | UpdateI18nAction\n\nexport interface SetLocaleAction {\n  type: 'jsonforms/SET_LOCALE';\n  locale: string | undefined;\n}\n\nexport const setLocale = (locale: string | undefined): SetLocaleAction => ({\n  type: SET_LOCALE,\n  locale\n});\n\nexport interface SetSchemaAction {\n  type: 'jsonforms/SET_SCHEMA';\n  schema: JsonSchema;\n}\n\nexport const setSchema = (schema: JsonSchema): SetSchemaAction => ({\n  type: SET_SCHEMA,\n  schema\n});\n\nexport interface SetTranslatorAction {\n  type: 'jsonforms/SET_TRANSLATOR';\n  translator?: Translator;\n  errorTranslator?: ErrorTranslator; \n}\n\nexport const setTranslator = (\n  translator?: Translator,\n  errorTranslator?: ErrorTranslator\n): SetTranslatorAction => ({\n  type: SET_TRANSLATOR,\n  translator,\n  errorTranslator\n});\n\nexport interface UpdateI18nAction {\n  type: 'jsonforms/UPDATE_I18N';\n  locale: string | undefined;\n  translator: Translator | undefined;\n  errorTranslator: ErrorTranslator | undefined; \n}\n\nexport const updateI18n = (\n  locale: string | undefined,\n  translator: Translator | undefined,\n  errorTranslator: ErrorTranslator | undefined\n): UpdateI18nAction => ({\n  type: UPDATE_I18N,\n  locale,\n  translator,\n  errorTranslator\n});\n\nexport interface SetUISchemaAction {\n  type: 'jsonforms/SET_UISCHEMA';\n  uischema: UISchemaElement;\n}\n\nexport const setUISchema = (uischema: UISchemaElement): SetUISchemaAction => ({\n  type: SET_UISCHEMA,\n  uischema\n});\n","/*\n  The MIT License\n  \n  Copyright (c) 2017-2019 EclipseSource Munich\n  https://github.com/eclipsesource/jsonforms\n  \n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n  \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n  THE SOFTWARE.\n*/\n\nimport { convertToValidClassName, createLabelDescriptionFrom } from './util';\nimport { ControlElement, JsonSchema, LabelDescription } from './models';\n\nexport const Helpers: {\n  createLabelDescriptionFrom(\n    withLabel: ControlElement,\n    schema: JsonSchema\n  ): LabelDescription;\n  convertToValidClassName(s: string): string;\n} = {\n  createLabelDescriptionFrom,\n  convertToValidClassName\n};\n"],"names":["RuleEffect","merge","isFunction","isEqual","cloneDeep","get","setFp","filter","isObjectSchema","isEmpty","endsWith","last","isArray","reduce","toPairs","includes","remove","maxBy","range","has","find","composePaths","startCase","union","Ajv","addFormats","keys"],"mappings":"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"}